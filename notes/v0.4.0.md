A handful of refinements after a bit of dogfooding.
