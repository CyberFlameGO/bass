<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <title>stdlib ; bass</title>
    <link rel="stylesheet" type="text/css" href="css/iosevka.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <script type="text/javascript" src="js/switcher.js"></script>
    <noscript>
      <link rel="stylesheet" type="text/css" href="css/base16/base16-rose-pine-moon.css" />
    </noscript>
  </head>
  <body>
    <div class="page">
      <h1 class="section-header highlight chroma"><a id="stdlib"></a>
  <span class="c1"><a class="section-anchor" href="stdlib.html"></a>stdlib</span>
</h1>




  
    <h2 class="section-header highlight chroma"><a id="ground"></a>
  <span class="c1"><a class="section-anchor" href="stdlib.html#ground"></a>ground</span>
</h2>

<div class="bass-commentary">
  <div class="literate"><p>This module bootstraps the ground scope with basic language facilities.</p></div><div class="bass-binding"><a id="def"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L35">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="k">def </span><span class="nb">binding </span><span class="nv">value</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>bind symbols to values in the current scope</p></div>
  </div>
  
</div><div class="bass-binding"><a id="null?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">null?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is null</p></div>
  </div>
  
</div><div class="bass-binding"><a id="ignore?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">ignore?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is _ (&#34;ignore&#34;)</p><p>_ is a special value used to ignore a value when binding symbols.</p><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">fst</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span><span class="p">]</span> <span class="nv">fst</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <code class="highlight chroma"><span class="mi">1</span></code>
    </div>
  </div>

</div></div>
  </div>
  
</div><div class="bass-binding"><a id="boolean?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">boolean?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is true or false</p></div>
  </div>
  
</div><div class="bass-binding"><a id="number?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">number?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a number</p></div>
  </div>
  
</div><div class="bass-binding"><a id="string?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">string? </span><span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a string</p></div>
  </div>
  
</div><div class="bass-binding"><a id="symbol?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">symbol? </span><span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a symbol</p></div>
  </div>
  
</div><div class="bass-binding"><a id="scope?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">scope?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a scope</p></div>
  </div>
  
</div><div class="bass-binding"><a id="sink?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">sink?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a sink</p><p>A sink is a type that you can send values to using (emit).</p></div>
  </div>
  
</div><div class="bass-binding"><a id="source?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">source?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a source</p><p>A source is a type that you can read values from using (next).</p></div>
  </div>
  
</div><div class="bass-binding"><a id="list?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">list?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a linked list</p><p>A linked list is a pair whose second value is another list or empty.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="pair?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">pair?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a pair</p></div>
  </div>
  
</div><div class="bass-binding"><a id="scope?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">scope?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a scope</p><p>A scope is a mapping from symbols to values.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="applicative?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">applicative?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is an applicative</p><p>An applicative is a combiner that wraps another combiner.</p><p>When an applicative is called, it evaluates its operands in the caller&#39;s evironment and passes them to the underlying combiner.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="operative?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">operative?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is an operative</p><p>An operative is a combiner that is given the caller&#39;s scope.</p><p>An operative may decide whether and how to evaluate its arguments. They are typically used to define new syntactic constructs.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="combiner?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">combiner?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a combiner</p><p>A combiner takes sequence of values as arguments and returns another value.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="path?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">path?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is a path</p><p>A path is a reference to a file, directory, or command.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="empty?"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L49">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">empty?</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns true if the value is an empty list, a zero-length string, an empty scope, or null</p></div>
  </div>
  
</div><div class="bass-binding"><a id="ground"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L52">
    <code class="chroma signature"><code class="highlight chroma"><span class="nv">ground</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">scope?</span> <span class="fg-yellow">scope?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>ground scope please ignore</p><p>This value is only here to aid in developing prior to first release.</p><p>Fetching this binding voids your warranty.</p></div>
  </div>
  
  <div class="binding-value">
    ground
  </div>
  
</div><div class="bass-binding"><a id="dump"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L56">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">dump</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>writes a value as JSON to stderr</p><p>Returns the given value.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="log"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L64">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">log</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>writes a string message or other arbitrary value to stderr</p><p>Returns the given value.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="logf"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L78">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">logf</span> <span class="nv">fmt</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>writes a message formatted with the given values</p></div>
  </div>
  
</div><div class="bass-binding"><a id="time"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L84">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">time </span><span class="nv">form</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>evaluates the form and prints the time it took</p><p>Returns the value returned by the form.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="now"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L96">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">now</span> <span class="nv">duration</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns the current UTC time truncated to the given duration (in seconds)</p><p>Typically used to annotate workloads whose result may change over time.</p><p>By specifying a duration, these workloads can still be cached to a configurable level of granularity.</p><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="nf">now</span> <span class="mi">60</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <code class="highlight chroma"><span class="s">&#34;2021-09-05T02:55:00Z&#34;</span></code>
    </div>
  </div>

</div></div>
  </div>
  
</div><div class="bass-binding"><a id="error"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L105">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">error</span> <span class="nv">msg</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>errors with the given message</p></div>
  </div>
  
</div><div class="bass-binding"><a id="errorf"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L109">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">errorf</span> <span class="nv">fmt</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>errors with a message formatted with the given values</p></div>
  </div>
  
</div><div class="bass-binding"><a id="do"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L115">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>evaluate a sequence, returning the last value</p></div>
  </div>
  
</div><div class="bass-binding"><a id="cons"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L121">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">cons </span><span class="nv">a</span> <span class="nv">d</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct a pair from the given values</p></div>
  </div>
  
</div><div class="bass-binding"><a id="wrap"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L127">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">comb</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct an applicative from a combiner (typically an operative)</p></div>
  </div>
  
</div><div class="bass-binding"><a id="unwrap"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L131">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">app</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>access an applicative&#39;s underlying combiner</p></div>
  </div>
  
</div><div class="bass-binding"><a id="eval"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L149">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">eval </span><span class="nv">form</span> <span class="nv">scope</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>evaluate a value in a scope</p></div>
  </div>
  
</div><div class="bass-binding"><a id="make-scope"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L155">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">make-scope</span> <span class="o">&amp;</span> <span class="nv">parents</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct a scope with the given parents</p></div>
  </div>
  
</div><div class="bass-binding"><a id="bind"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L159">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">bind</span> <span class="nv">scope</span> <span class="nv">formals</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>attempts to bind values in the scope</p><p>Returns true if the binding succeeded, otherwise false.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="doc"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L167">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">doc </span><span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>print docs for symbols</p><p>Prints the documentation for the given symbols resolved from the current scope.</p><p>With no arguments, prints the commentary for the current scope.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="comment"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L173">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">comment </span><span class="nv">form</span> <span class="nv">annotated</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>record a comment</p><p>Splices one annotated value with another, recording commentary in the current scope.</p><p>Typically used by operatives to preserve commentary between scopes.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="commentary"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L191">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">commentary</span> <span class="nv">sym</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>return the comment string associated to the symbol</p><p>Typically used by operatives to preserve commentary between scopes.</p><p>Use (doc) instead for prettier output.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="if"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L206">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="k">if </span><span class="nb">cond </span><span class="nv">yes</span> <span class="nv">no</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>if then else (branching logic)</p><p>Evaluates a condition. If nil or false, evaluates the third operand. Otherwise, evaluates the second operand.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="&#43;"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L225">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">+ </span><span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sum the given numbers</p></div>
  </div>
  
</div><div class="bass-binding"><a id="*"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L236">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">* </span><span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>multiply the given numbers</p></div>
  </div>
  
</div><div class="bass-binding"><a id="-"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L247">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">- </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>subtract ys from x</p><p>If only x is given, returns the negation of x.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="max"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L263">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">max </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>largest number given</p></div>
  </div>
  
</div><div class="bass-binding"><a id="min"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L276">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">min </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>smallest number given</p></div>
  </div>
  
</div><div class="bass-binding"><a id="="></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L289">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">= </span><span class="nb">val </span><span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>numeric equality</p></div>
  </div>
  
</div><div class="bass-binding"><a id="&gt;"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L302">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">&gt; </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>descending order</p></div>
  </div>
  
</div><div class="bass-binding"><a id="&gt;="></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L317">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">&gt;= </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>descending or equal order</p></div>
  </div>
  
</div><div class="bass-binding"><a id="&lt;"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L332">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">&lt; </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>increasing order</p></div>
  </div>
  
</div><div class="bass-binding"><a id="&lt;="></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L347">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>increasing or equal order</p></div>
  </div>
  
</div><div class="bass-binding"><a id="*stdin*"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L362">
    <code class="chroma signature"><code class="highlight chroma"><span class="nv">*stdin*</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">source?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>A source? of values read from stdin.</p></div>
  </div>
  
  <div class="binding-value">
    <code class="highlight chroma"><span class="nv">&lt;source</span><span class="err">:</span> <span class="nv">stdin&gt;</span></code>
  </div>
  
</div><div class="bass-binding"><a id="*stdout*"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L363">
    <code class="chroma signature"><code class="highlight chroma"><span class="nv">*stdout*</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">sink?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>A sink? for writing values to stdout.</p></div>
  </div>
  
  <div class="binding-value">
    <code class="highlight chroma"><span class="nv">&lt;sink</span><span class="err">:</span> <span class="nv">stdout&gt;</span></code>
  </div>
  
</div><div class="bass-binding"><a id="stream"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L365">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">stream</span> <span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct a stream source for a sequence of values</p></div>
  </div>
  
</div><div class="bass-binding"><a id="emit"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L371">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">emit</span> <span class="nb">val </span><span class="nv">sink</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>send a value to a sink</p></div>
  </div>
  
</div><div class="bass-binding"><a id="next"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L378">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">next </span><span class="nv">src</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>receive the next value from a source</p><p>If the stream has ended, no value will be available. A default value may be provided, otherwise an error is raised.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="reduce-kv"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L395">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">reduce-kv</span> <span class="nv">f</span> <span class="nv">init</span> <span class="nv">kv</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>reduces a scope</p><p>Takes a 3-arity function, an initial value, and a scope. If the scope is empty, the initial value is returned. Otherwise, calls the function for each key-value pair, with the current value as the first argument.</p><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="nf">reduce-kv</span> <span class="nb">assoc </span><span class="p">{</span><span class="ss">:d</span> <span class="mi">4</span><span class="p">}</span> <span class="p">{</span><span class="ss">:a</span> <span class="mi">1</span> <span class="ss">:b</span> <span class="mi">2</span> <span class="ss">:c</span> <span class="mi">3</span><span class="p">}</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">a</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">1</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">b</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">2</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">c</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">3</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">d</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">4</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div>
    </div>
  </div>

</div></div>
  </div>
  
</div><div class="bass-binding"><a id="assoc"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L422">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">assoc </span><span class="nv">obj</span> <span class="o">&amp;</span> <span class="nv">kvs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>assoc[iate] keys with values in a clone of a scope</p><p>Takes a scope and a flat pair sequence alternating symbols and values.</p><p>Returns a clone of the scope with the symbols fields set to their associated value.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="symbol-&gt;string"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L454">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">symbol-&gt;string</span> <span class="nv">sym</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>convert a symbol to a string</p></div>
  </div>
  
</div><div class="bass-binding"><a id="string-&gt;symbol"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L460">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">str</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>convert a string to a symbol</p></div>
  </div>
  
</div><div class="bass-binding"><a id="str"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L466">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">str </span><span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns the concatenation of all given strings or values</p></div>
  </div>
  
</div><div class="bass-binding"><a id="substring"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L483">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">substring</span> <span class="nb">str </span><span class="nv">start</span> <span class="o">&amp;</span> <span class="nv">end</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns a portion of a string</p><p>With one number supplied, returns the portion from the offset to the end.</p><p>With two numbers supplied, returns the portion between the first offset and the last offset, exclusive.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="scope-&gt;list"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L503">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">scope-&gt;list</span> <span class="nv">obj</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns a flat list alternating a scope&#39;s keys and values</p><p>The returned list is the same form accepted by (map-pairs).</p></div>
  </div>
  
</div><div class="bass-binding"><a id="run"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L566">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">run</span> <span class="nv">workload</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>run a workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="path"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/ground.go#L583">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">path </span><span class="nv">workload</span> <span class="nv">path</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns a path within a workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="list"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L4">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">list </span><span class="o">&amp;</span> <span class="nv">values</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct a list from a sequence of values</p><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="nb">list </span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <div class="delimited">
  <div class="open"><code class="chroma p">(</code></div>
  <div class="content">
    <ol class="bass-list">
    
      <li><code class="highlight chroma"><span class="mi">1</span></code></li>
    
      <li><code class="highlight chroma"><span class="mi">2</span></code></li>
    
      <li><code class="highlight chroma"><span class="mi">3</span></code></li>
    
    </ol>
  </div>
  <div class="close"><code class="chroma p">)</code></div>
</div>
    </div>
  </div>

</div></div>
  </div>
  
</div><div class="bass-binding"><a id="list*"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L7">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">list* </span><span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>prepend a sequence of values to a list given as the final argument</p></div>
  </div>
  
</div><div class="bass-binding"><a id="first"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L20">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nf">f</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>return the first value in a pair</p></div>
  </div>
  
</div><div class="bass-binding"><a id="rest"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L23">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">rest </span><span class="p">(</span><span class="nf">_</span> <span class="o">&amp;</span> <span class="nv">r</span><span class="p">)</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>return the second value in a pair, i.e. the rest of a linked list</p></div>
  </div>
  
</div><div class="bass-binding"><a id="length"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L26-L31">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">length</span> <span class="nv">xs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>return the length of the given list</p></div>
  </div>
  
</div><div class="bass-binding"><a id="op"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L39-L48">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct an operative</p><p>An operative is a combiner that is called with unevaluated arguments and the caller&#39;s dynamic scope.</p><p>Operatives are used to define new syntactic constructs.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="defop"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L54-L56">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">defop</span> <span class="nb">name </span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct an operative and bind it to a symbol</p><p>Returns the bound symbol. Write a comment before (defop) to provide documentation.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="fn"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L62-L63">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct a function</p><p>Functions are applicative combiners which evaluate their arguments before passing them to an underlying operative.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="defn"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L69-L70">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="kd">defn </span><span class="nb">name </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>construct a function and bind it to a symbol</p><p>Returns the bound symbol. Write a comment before (defn) to provide documentation.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="second"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L73">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">second </span><span class="p">(</span><span class="nf">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>return the second member of a linked list</p></div>
  </div>
  
</div><div class="bass-binding"><a id="third"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L76">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">third</span> <span class="p">(</span><span class="nf">_</span> <span class="nv">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>return third member of a linked list</p></div>
  </div>
  
</div><div class="bass-binding"><a id="get-current-scope"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L79">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">get-current-scope</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>return the current scope</p></div>
  </div>
  
</div><div class="bass-binding"><a id="quote"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L82">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="k">quote </span><span class="nv">form</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns the unevaluated form</p></div>
  </div>
  
</div><div class="bass-binding"><a id="map"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L85-L90">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">map </span><span class="nv">f</span> <span class="nv">xs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns a list containing the result of applying f to each member of xs</p></div>
  </div>
  
</div><div class="bass-binding"><a id="map-pairs"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L100">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">map-pairs</span> <span class="nv">f</span> <span class="nv">ps</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>calls a function with alternating pairs in a flat list (i.e. with pairs ungrouped)</p><p>Takes 2-arity function and a flat pair sequence. Walks the sequence and calls f with 2 values at a time.</p><p>Raises an error if the list has uneven length.</p><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="nf">map-pairs</span> <span class="nb">cons </span><span class="p">[</span><span class="ss">:a</span> <span class="mi">1</span> <span class="ss">:b</span> <span class="mi">2</span> <span class="ss">:c</span> <span class="mi">3</span><span class="p">]</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <div class="delimited">
  <div class="open"><code class="chroma p">(</code></div>
  <div class="content">
    <ol class="bass-list">
    
      <li><code class="highlight chroma"><span class="p">(</span><span class="nf">a</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span></code></li>
    
      <li><code class="highlight chroma"><span class="p">(</span><span class="nf">b</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">)</span></code></li>
    
      <li><code class="highlight chroma"><span class="p">(</span><span class="nf">c</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span></code></li>
    
    </ol>
  </div>
  <div class="close"><code class="chroma p">)</code></div>
</div>
    </div>
  </div>

</div></div>
  </div>
  
</div><div class="bass-binding"><a id="let"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L120-L128">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="k">let </span><span class="nv">bindings</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>binds values in a child scope</p><p>Takes a flat pair sequence alternating bindings and their values. Binds and evaluates each value in sequence, allowing later bindings to refer to earlier bindings.</p><p>Returns the result of evaluating the body in the child scope.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="provide"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L134-L143">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">provide</span> <span class="nv">symbols</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>provide bindings to the current scope from a nested scope</p><p>Allows for modularity in code, selectively providing bindings while encapsulating bindings that they use.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="set!"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L146-L148">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">set!</span> <span class="nv">target</span> <span class="nv">symbols</span> <span class="nv">values</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>binds symbols to values in the target scope</p></div>
  </div>
  
</div><div class="bass-binding"><a id="import"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L152-L154">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">import </span><span class="nv">source</span> <span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>binds symbols in the current scope to their values from the source scope</p></div>
  </div>
  
</div><div class="bass-binding"><a id="cond"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L179-L186">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">cond </span><span class="o">&amp;</span> <span class="nv">clauses</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>if-then-else with many clauses</p><p>Takes a flat pair sequence alternating tests to evaluate and an expression to evaluate if the test returns a truthy value.</p><p>Returns the result of the evaluated branch, or null if no tests were true.</p><p>By convention, :else is used as the final catch-all test, though any truthy value works.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="or"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L189">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">or </span><span class="o">&amp;</span> <span class="nv">conds</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>lazily evaluated boolean &#39;or&#39;</p></div>
  </div>
  
</div><div class="bass-binding"><a id="and"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L205">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">and </span><span class="o">&amp;</span> <span class="nv">conds</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>lazily evaluated boolean &#39;and&#39;</p></div>
  </div>
  
</div><div class="bass-binding"><a id="apply"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L228-L232">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">apply </span><span class="nv">appv</span> <span class="nv">arg</span> <span class="o">&amp;</span> <span class="nv">opt</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>call an applicative&#39;s underlying operative with a list of arguments</p><p>A scope may be provided as the third argument. If not specified, the operative will be called in a new empty scope.</p><p>Used to call an applicative with pre-evaluated arguments, skipping the normal evaluation the applicative would perform prior to calling the underlying operative.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="-&gt;"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L243-L250">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">-&gt; </span><span class="nv">x</span> <span class="nv">f</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>threads a value through forms</p><p>Calls the first form with the given value, passing the result to the second form, and so on, returning the final value.</p><p>A form may be a list or a single value. For a list, the value is inserted before the second value, becoming the first argument. For a single value, it is wrapped in a list with the value as the single argument.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="case"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L263-L264">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">case</span> <span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">bs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>evaluates the branch that successfully binds the given value</p></div>
  </div>
  
</div><div class="bass-binding"><a id="id"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/root.bass#L267">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">id</span> <span class="nv">x</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>identity function; returns its argument</p></div>
  </div>
  
</div><div class="bass-binding"><a id="conj"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/lists.bass#L24-L28">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">conj </span><span class="nv">xs</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>conjoins values onto the end of a list</p></div>
  </div>
  
</div><div class="bass-binding"><a id="list-&gt;scope"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/lists.bass#L31-L32">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">kwargs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>constructs an object from a list of flat keyword/value pairs</p></div>
  </div>
  
</div><div class="bass-binding"><a id="last"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/streams.bass#L5-L12">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns the last value from the stream</p><p>As with (next), a default may be provided to be returned when the stream is empty. If not provided, an error will be raised if the stream is empty.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="each"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/streams.bass#L17-L23">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">each</span> <span class="nv">stream</span> <span class="nv">f</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>calls f for every value read from the stream</p><p>Returns null.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="arg"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L5-L6">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">arg</span> <span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>returns a structure which will join the given values into a single string value</p><p>Used to concatenate paths with string values to be passed as an argument to a workload.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-args"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L9-L10">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-args</span> <span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :args field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-stdin"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L13-L14">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-stdin</span> <span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">stdin</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :stdin field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-entrypoint"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L17-L18">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-entrypoint</span> <span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">entrypoint</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :entrypoint field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="insecure!"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L21-L22">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">insecure!</span> <span class="nv">workload</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :insecure field of the workload to true</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-insecure"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L25-L26">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-insecure</span> <span class="nv">workload</span> <span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :insecure field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="$"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L42-L47">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">$</span> <span class="nv">cmd</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">operative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>constructs a workload with args set as :args</p><p>Symbol arguments are automatically converted to strings. Symbols beginning with $ are resolved to their binding with the leading $ removed.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="*default-platform*"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L59-L60">
    <code class="chroma signature"><code class="highlight chroma"><span class="nv">*default-platform*</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">scope?</span> <span class="fg-yellow">scope?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>the default platform for workloads that configure an image</p></div>
  </div>
  
  <div class="binding-value">
    <div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;linux&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div>
  </div>
  
</div><div class="bass-binding"><a id="in-image"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L63-L68">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">in-image</span> <span class="nv">workload</span> <span class="nv">image</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :image field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="on-platform"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L71-L72">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">on-platform</span> <span class="nv">workload</span> <span class="nv">platform</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :platform field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="response-from"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L79-L86">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">response-from</span> <span class="nv">workload</span> <span class="nv">source</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :response field of the workload</p><p>If source is :stdout, sets it to {:stdout true}. If source is :exit, sets it to {:exit-code true}. If source is a path?, sets it to {:file source}.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="in-dir"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L89-L90">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">in-dir</span> <span class="nv">workload</span> <span class="nv">dir</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :dir field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-mount"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L93-L97">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-mount</span> <span class="nv">workload</span> <span class="nv">source</span> <span class="nv">target</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>appends a mount to the :mounts field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-mounts"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L100-L101">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-mounts</span> <span class="nv">workload</span> <span class="nv">mounts</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :mounts field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-env-var"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L106-L107">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-env-var</span> <span class="nv">workload</span> <span class="nb">name </span><span class="nv">value</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>inserts an env var and value into the :env field of the workload</p><p>TODO: append, add in stable order</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-env"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L110-L111">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">with-env</span> <span class="nv">workload</span> <span class="nv">env</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>sets the :env field of the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="with-meta"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/run.bass#L114-L115">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">with-meta </span><span class="nv">workload</span> <span class="nb">key </span><span class="nv">val</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>attaches metadata to the workload</p></div>
  </div>
  
</div><div class="bass-binding"><a id="not"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/bool.bass#L10-L11">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">not </span><span class="nv">x</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>negates the given bool-ish value</p><p>Returns true for false and null. Returns false otherwise.</p><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="nb">not </span><span class="nv">true</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <code class="highlight chroma"><span class="nv">false</span></code>
    </div>
  </div>

</div><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="nb">not </span><span class="nv">null</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <code class="highlight chroma"><span class="nv">true</span></code>
    </div>
  </div>

</div><div class="code-with-output">
  <div class="section code">
    <div class="highlight"><pre tabindex="0" class="chroma"><span class="p">(</span><span class="nb">not </span><span class="nv">false</span><span class="p">)</span>
</pre></div>
  </div>






  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <code class="highlight chroma"><span class="nv">true</span></code>
    </div>
  </div>

</div></div>
  </div>
  
</div>
</div>


  

  
    <h2 class="section-header highlight chroma"><a id="strings"></a>
  <span class="c1"><a class="section-anchor" href="stdlib.html#strings"></a>strings</span>
</h2>

<div class="code-with-output">
  <div class="section code">
    <code class="highlight chroma"><span class="p">(</span><span class="nb">load </span><span class="p">(</span><span class="nf">.strings</span><span class="p">)</span><span class="p">)</span></code>
  </div>


  <div class="section stderr">
    <span class="section-label">stderr</span>

    <pre><div class="ansi-line"><span class="fg-magenta ">debug</span><span class=" ">	loading workload	{&#34;workload&#34;: &#34;9bd3b8606144f1b30c031e9fa327879b0bd32959&#34;, &#34;path&#34;: &#34;.strings&#34;}</span></div></pre>
  </div>





  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">$</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">cmd</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">as</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">resolve-arg</span> <span class="nv">a</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="nv">args</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">with-args</span> <span class="p">[</span><span class="p">(</span><span class="p">(</span><span class="nb">eval </span><span class="nv">cmd</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">* </span><span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*args*</span></code></div>
        
        <div class="object-cell"><div class="delimited">
  <div class="open"><code class="chroma p">(</code></div>
  <div class="content">
    <ol class="bass-list">
    
    </ol>
  </div>
  <div class="close"><code class="chroma p">)</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*default-platform*</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;linux&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*dir*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">{</span><span class="nv">%!s</span><span class="p">(</span><span class="nf">*</span><span class="p">[</span><span class="p">]</span><span class="nv">embed.file=</span><span class="o">&amp;</span><span class="p">[</span><span class="p">{</span><span class="nv">bool.bass</span> <span class="c1">; negates the given bool-ish value</span>
<span class="c1">;</span>
<span class="c1">; Returns true for false and null. Returns false otherwise.</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (not true)</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (not null)</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (not false)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">not </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span>
	<span class="p">(</span><span class="k">if </span><span class="nv">x</span> <span class="nv">false</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">140</span> <span class="mi">74</span> <span class="mi">29</span> <span class="mi">144</span> <span class="mi">51</span> <span class="mi">132</span> <span class="mi">198</span> <span class="mi">144</span> <span class="mi">159</span> <span class="mi">72</span> <span class="mi">240</span> <span class="mi">110</span> <span class="mi">160</span> <span class="mi">202</span> <span class="mi">22</span> <span class="mi">157</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">concourse.bass</span> <span class="p">(</span><span class="nf">provide</span>
  <span class="p">[</span>
   <span class="nv">*default-config*</span>

   <span class="nv">resource</span>
   <span class="nv">get-latest</span>

   <span class="nv">run-task</span>

   <span class="nv">get-image-resource</span>
   <span class="nv">get-latest-image-resource</span>
  <span class="p">]</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">dur</span> <span class="p">(</span><span class="nb">load </span><span class="p">(</span><span class="nf">.durations</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; a convenient mapping from type keywords to their image</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">*core-types*</span>
    <span class="p">{</span><span class="ss">:registry-image</span> <span class="s">&#34;concourse/registry-image-resource&#34;</span>
     <span class="ss">:docker-image</span> <span class="s">&#34;concourse/docker-image-resource&#34;</span>
     <span class="ss">:git</span> <span class="s">&#34;concourse/git-resource&#34;</span>
     <span class="ss">:time</span> <span class="s">&#34;concourse/time-resource&#34;</span><span class="p">}</span><span class="p">)</span>

  <span class="c1">; the default configuration, if none is supplied on *stdin*</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">*default-config*</span>
    <span class="p">{</span><span class="ss">:platforms</span> <span class="p">{</span><span class="ss">:linux</span> <span class="nv">linux</span><span class="p">}</span>
     <span class="ss">:types</span> <span class="nv">*core-types*</span>
     <span class="ss">:check-interval</span> <span class="nv">dur</span><span class="ss">:hour</span>
     <span class="ss">:image-check-interval</span> <span class="nv">dur</span><span class="ss">:day</span><span class="p">}</span><span class="p">)</span>

  <span class="p">(</span><span class="k">def </span><span class="nv">*config*</span>
    <span class="p">(</span><span class="nb">merge </span><span class="nv">*default-config*</span> <span class="p">(</span><span class="nb">next </span><span class="nv">*stdin*</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; constructs a resource scope</span>
  <span class="c1">;</span>
  <span class="c1">; If type is a keyword, it is mapped to an image via :types in the module</span>
  <span class="c1">; configuration.</span>
  <span class="c1">;</span>
  <span class="c1">; Otherwise, it is passed along to `in-image`.</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">resource</span> <span class="p">[</span><span class="nv">type</span> <span class="nv">source</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">provide</span> <span class="p">[</span><span class="nv">check</span> <span class="nv">check-every</span> <span class="nb">get </span><span class="nv">put</span><span class="p">]</span>
      <span class="c1">; detect new versions of the resource with the default interval</span>
      <span class="c1">;</span>
      <span class="c1">; An optional cursor version to check from may be provided.</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nv">check</span> <span class="nv">optional-version</span>
        <span class="p">(</span><span class="nf">check-every</span> <span class="nv">*config*</span><span class="ss">:check-interval</span> <span class="o">&amp;</span> <span class="nv">optional-version</span><span class="p">)</span><span class="p">)</span>

      <span class="c1">; detect new versions of the resource with the given interval</span>
      <span class="c1">;</span>
      <span class="c1">; An optional cursor version to check from may be provided.</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nv">check-every</span> <span class="p">[</span><span class="nv">interval</span> <span class="o">&amp;</span> <span class="nv">optional-version</span><span class="p">]</span>
        <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">version</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">optional-version</span> <span class="p">[</span><span class="p">]</span> <span class="nv">null</span> <span class="p">(</span><span class="nf">v</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span> <span class="nv">v</span><span class="p">)</span><span class="p">]</span>
          <span class="p">(</span><span class="nb">apply </span><span class="nv">stream</span> <span class="p">(</span><span class="nb">next </span><span class="p">(</span><span class="nf">run</span> <span class="p">(</span><span class="nf">check-wl</span> <span class="nv">version</span> <span class="nv">interval</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="c1">; fetch a version of the resource</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nb">get </span><span class="p">[</span><span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">params</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">path </span><span class="p">(</span><span class="nf">get-wl</span> <span class="nv">version</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">params</span><span class="p">)</span><span class="p">)</span> <span class="nv">./</span><span class="p">)</span><span class="p">)</span>

      <span class="c1">; create or update a version of the resource</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nv">put</span> <span class="nv">params</span>
        <span class="p">(</span><span class="nb">next </span><span class="p">(</span><span class="nf">run</span> <span class="p">(</span><span class="nf">put-wl</span> <span class="nv">version</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">params</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="k">def </span><span class="nv">image</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">symbol? </span><span class="nv">type</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">*config*</span> <span class="ss">:types</span> <span class="nv">type</span><span class="p">)</span>
          <span class="nv">type</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="kd">defn </span><span class="nv">check-wl</span> <span class="p">[</span><span class="nv">version</span> <span class="nv">interval</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/check</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:version</span> <span class="nv">version</span><span class="p">}</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">with-meta </span><span class="ss">:at</span> <span class="p">(</span><span class="nf">now</span> <span class="nv">interval</span><span class="p">)</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="kd">defn </span><span class="nv">get-wl</span> <span class="p">[</span><span class="nv">version</span> <span class="nv">params</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/in</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:version</span> <span class="nv">version</span> <span class="ss">:params</span> <span class="nv">params</span><span class="p">}</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">with-args</span> <span class="nv">./</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="kd">defn </span><span class="nv">put-wl</span> <span class="p">[</span><span class="nv">params</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/out</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:params</span> <span class="nv">params</span><span class="p">}</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">with-args</span> <span class="nv">./</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

    <span class="p">(</span><span class="nf">get-current-scope</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; gets the latest version of a resource</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">get-latest</span> <span class="p">[</span><span class="nv">r</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">r</span><span class="ss">:get</span> <span class="p">(</span><span class="nb">last </span><span class="p">(</span><span class="nf">r</span><span class="ss">:check</span><span class="p">)</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="k">def </span><span class="nv">yaml</span>
    <span class="p">(</span><span class="nb">load </span><span class="p">(</span><span class="nf">.yaml</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; run a task with the given parameters</span>
  <span class="c1">;</span>
  <span class="c1">; The :inputs param provides as a mapping from name to workload path.</span>
  <span class="c1">;</span>
  <span class="c1">; Returns an scope with :outputs bound to a mapping from name to workload</span>
  <span class="c1">; path, and :result bound to the workload&#39;s stream.</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">run-task</span> <span class="p">[</span><span class="nv">config-path</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">config</span> <span class="p">(</span><span class="nf">yaml</span><span class="ss">:decode</span> <span class="nv">config-path</span><span class="p">)</span>
          <span class="nv">opts</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">kwargs</span><span class="p">)</span>
          <span class="nv">workload</span> <span class="p">(</span><span class="nf">task-&gt;workload</span> <span class="nv">config</span> <span class="nv">opts</span><span class="p">)</span>

          <span class="nv">output-configs</span> <span class="p">(</span><span class="ss">:outputs</span> <span class="nv">config</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span>
          <span class="nv">output-pairs</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">output</span><span class="p">]</span>
                              <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">name </span><span class="p">(</span><span class="ss">:name</span> <span class="nv">output</span><span class="p">)</span>
                                    <span class="nv">src</span> <span class="p">(</span><span class="ss">:path</span> <span class="nv">output</span> <span class="nv">name</span><span class="p">)</span><span class="p">]</span>
                                <span class="p">[</span><span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">name</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nb">path </span><span class="nv">workload</span> <span class="p">(</span><span class="nf">string-&gt;dir</span> <span class="nv">src</span><span class="p">)</span><span class="p">)</span><span class="p">]</span><span class="p">)</span><span class="p">)</span>
                            <span class="nv">output-configs</span><span class="p">)</span>
          <span class="nv">outputs</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">append</span> <span class="nv">output-pairs</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
      <span class="p">{</span><span class="ss">:outputs</span> <span class="nv">outputs</span>
       <span class="ss">:result</span> <span class="p">(</span><span class="nf">run</span> <span class="nv">workload</span><span class="p">)</span><span class="p">}</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">task-&gt;workload</span> <span class="p">[</span><span class="nv">config</span> <span class="nv">opts</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">platform-name</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:platform</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">platform</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">*config*</span> <span class="ss">:platforms</span> <span class="nv">platform-name</span><span class="p">)</span>

          <span class="nv">image-type-name</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="ss">:type</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">image-type</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">*config*</span> <span class="ss">:types</span> <span class="nv">image-type-name</span><span class="p">)</span>
          <span class="nv">image-source</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="ss">:source</span><span class="p">)</span>
          <span class="nv">image-params</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="p">(</span><span class="ss">:params</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nv">scope-&gt;list</span><span class="p">)</span>
          <span class="nv">image-version</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="p">(</span><span class="ss">:version</span> <span class="nv">null</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">image-resource</span> <span class="p">(</span><span class="nf">resource</span> <span class="nv">image-type</span> <span class="nv">image-source</span><span class="p">)</span>
          <span class="nv">image</span> <span class="p">(</span><span class="k">if </span><span class="nv">image-version</span>
                  <span class="p">(</span><span class="nf">get-image-resource</span> <span class="nv">image-resource</span> <span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">image-params</span><span class="p">)</span>
                  <span class="p">(</span><span class="nf">get-latest-image-resource</span> <span class="nv">image-resource</span> <span class="o">&amp;</span> <span class="nv">image-params</span><span class="p">)</span><span class="p">)</span>

          <span class="nv">run-path</span> <span class="p">(</span><span class="nf">string-&gt;path</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:run</span> <span class="ss">:path</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">run-args</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:run</span> <span class="p">(</span><span class="ss">:args</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">run-dir</span> <span class="p">(</span><span class="nf">string-&gt;dir</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:run</span> <span class="p">(</span><span class="ss">:dir</span> <span class="s">&#34;.&#34;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

          <span class="nv">privileged</span> <span class="p">(</span><span class="ss">:privileged</span> <span class="nv">opts</span> <span class="nv">false</span><span class="p">)</span>

          <span class="nv">provided-inputs</span> <span class="p">(</span><span class="ss">:inputs</span> <span class="nv">opts</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span>
          <span class="nv">configured-inputs</span> <span class="p">(</span><span class="ss">:inputs</span> <span class="nv">config</span><span class="p">)</span>
          <span class="nv">mounts</span> <span class="p">(</span><span class="nb">filter </span><span class="nv">id</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">i</span><span class="p">]</span> <span class="p">(</span><span class="nf">input-mount</span> <span class="nv">provided-inputs</span> <span class="nv">i</span><span class="p">)</span><span class="p">)</span>
                                 <span class="nv">configured-inputs</span><span class="p">)</span><span class="p">)</span>

          <span class="nv">configured-params</span> <span class="p">(</span><span class="ss">:params</span> <span class="nv">config</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span>
          <span class="nv">provided-params</span> <span class="p">(</span><span class="ss">:params</span> <span class="nv">opts</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span>
          <span class="nv">env</span> <span class="p">(</span><span class="nf">reduce-kv</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">r</span> <span class="nv">k</span> <span class="nv">v</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">r</span> <span class="nv">k</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">v</span><span class="p">)</span> <span class="s">&#34;&#34;</span> <span class="nv">v</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
                         <span class="p">{</span><span class="p">}</span>
                         <span class="p">(</span><span class="nb">merge </span><span class="nv">configured-params</span> <span class="nv">provided-params</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">run-path</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-args</span> <span class="o">&amp;</span> <span class="nv">run-args</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">in-dir</span> <span class="nv">run-dir</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-mounts</span> <span class="nv">mounts</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-env</span> <span class="nv">env</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">on-platform</span> <span class="nv">platform</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-insecure</span> <span class="nv">privileged</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">response-from</span> <span class="ss">:exit</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">get-latest-image-resource</span> <span class="p">[</span><span class="nv">resource</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">check</span> <span class="p">(</span><span class="nf">resource</span><span class="ss">:check-every</span> <span class="nv">*config*</span><span class="ss">:image-check-interval</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="nf">get-image-resource</span> <span class="nv">resource</span> <span class="p">(</span><span class="nb">last </span><span class="nv">check</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">get-image-resource</span> <span class="p">[</span><span class="nv">resource</span> <span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">got</span> <span class="p">(</span><span class="nf">resource</span><span class="ss">:get</span> <span class="nv">version</span> <span class="ss">:format</span> <span class="s">&#34;oci&#34;</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">]</span>
      <span class="nv">got/image.tar</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">input-mount</span> <span class="p">[</span><span class="nv">inputs</span> <span class="nv">input</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">name </span><span class="p">(</span><span class="ss">:name</span> <span class="nv">input</span><span class="p">)</span>
          <span class="nv">input-name</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">name</span><span class="p">)</span>
          <span class="nv">source</span> <span class="p">(</span><span class="nf">input-name</span> <span class="nv">inputs</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="k">if </span><span class="nv">source</span>
        <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span>
         <span class="ss">:target</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">input</span> <span class="p">(</span><span class="ss">:path</span> <span class="nv">name</span><span class="p">)</span> <span class="nv">string-&gt;dir</span><span class="p">)</span><span class="p">}</span>
        <span class="nv">null</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">71</span> <span class="mi">164</span> <span class="mi">246</span> <span class="mi">203</span> <span class="mi">11</span> <span class="mi">114</span> <span class="mi">12</span> <span class="mi">7</span> <span class="mi">215</span> <span class="mi">81</span> <span class="mi">55</span> <span class="mi">229</span> <span class="mi">94</span> <span class="mi">79</span> <span class="mi">249</span> <span class="mi">231</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">durations.bass</span> <span class="c1">; 60 seconds</span>
<span class="p">(</span><span class="k">def </span><span class="nv">minute</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1">; 60 minutes</span>
<span class="p">(</span><span class="k">def </span><span class="nv">hour</span> <span class="p">(</span><span class="nb">* </span><span class="nv">minute</span> <span class="mi">60</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 24 hours</span>
<span class="p">(</span><span class="k">def </span><span class="nv">day</span> <span class="p">(</span><span class="nb">* </span><span class="nv">hour</span> <span class="mi">24</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 7 days</span>
<span class="p">(</span><span class="k">def </span><span class="nv">week</span> <span class="p">(</span><span class="nb">* </span><span class="nv">day</span> <span class="mi">7</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 4 weeks</span>
<span class="p">(</span><span class="k">def </span><span class="nv">month</span> <span class="p">(</span><span class="nb">* </span><span class="nv">week</span> <span class="mi">4</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 12 months</span>
<span class="p">(</span><span class="k">def </span><span class="nv">year</span> <span class="p">(</span><span class="nb">* </span><span class="nv">month</span> <span class="mi">12</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">118</span> <span class="mi">18</span> <span class="mi">128</span> <span class="mi">62</span> <span class="mi">139</span> <span class="mi">247</span> <span class="mi">192</span> <span class="mi">187</span> <span class="mi">75</span> <span class="mi">157</span> <span class="mi">209</span> <span class="mi">17</span> <span class="mi">237</span> <span class="mi">254</span> <span class="mi">217</span> <span class="mi">209</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">lists.bass</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">foldr</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span>
    <span class="p">[</span><span class="p">]</span> <span class="nv">z</span>
    <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">foldr</span> <span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">foldl</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span>
    <span class="p">[</span><span class="p">]</span> <span class="nv">z</span>
    <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">foldl</span> <span class="nv">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">z</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">append</span><span class="p">)</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">append1</span> <span class="p">[</span><span class="nv">xs</span> <span class="nv">ys</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span>
      <span class="p">[</span><span class="p">]</span> <span class="nv">ys</span>
      <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="p">(</span><span class="nf">append1</span> <span class="nv">xs</span><span class="o">&#39;</span> <span class="nv">ys</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">append</span> <span class="nv">xss</span>
    <span class="p">(</span><span class="nf">foldl</span> <span class="nv">append1</span> <span class="p">[</span><span class="p">]</span> <span class="nv">xss</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="kd">defn </span><span class="nb">filter </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">apply </span><span class="nv">append</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span><span class="p">)</span> <span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; conjoins values onto the end of a list</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">conj </span><span class="p">[</span><span class="nv">xs</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span>
    <span class="p">[</span><span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">conj </span><span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; constructs an object from a list of flat keyword/value pairs</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">list-&gt;scope</span> <span class="p">[</span><span class="nv">kwargs</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="p">{</span><span class="p">}</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">67</span> <span class="mi">174</span> <span class="mi">154</span> <span class="mi">224</span> <span class="mi">18</span> <span class="mi">178</span> <span class="mi">55</span> <span class="mi">101</span> <span class="mi">17</span> <span class="mi">216</span> <span class="mi">49</span> <span class="mi">236</span> <span class="mi">105</span> <span class="mi">164</span> <span class="mi">170</span> <span class="mi">86</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">root.bass</span> <span class="c1">; construct a list from a sequence of values</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (list 1 2 3)</span>
<span class="p">(</span><span class="k">def </span><span class="nb">list </span><span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="nv">values</span> <span class="nv">_</span> <span class="nv">values</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; prepend a sequence of values to a list given as the final argument</span>
<span class="p">(</span><span class="k">def </span><span class="nv">list*</span>
  <span class="p">(</span><span class="nf">wrap</span>
    <span class="p">(</span><span class="nf">op</span> <span class="nv">args</span> <span class="nv">_</span>
      <span class="p">(</span><span class="nf">do</span>
        <span class="p">(</span><span class="k">def </span><span class="nv">aux</span>
          <span class="p">(</span><span class="nf">wrap</span>
            <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="p">(</span><span class="nf">head</span> <span class="o">&amp;</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span> <span class="nv">_</span>
              <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">tail</span><span class="p">)</span>
                <span class="nv">head</span>
                <span class="p">(</span><span class="nb">cons </span><span class="nv">head</span> <span class="p">(</span><span class="nf">aux</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">aux</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the first value in a pair</span>
<span class="p">(</span><span class="k">def </span><span class="nb">first </span><span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="p">(</span><span class="nf">f</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">f</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the second value in a pair, i.e. the rest of a linked list</span>
<span class="p">(</span><span class="k">def </span><span class="nb">rest </span><span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="o">&amp;</span> <span class="nv">r</span><span class="p">)</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">r</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the length of the given list</span>
<span class="p">(</span><span class="k">def </span><span class="nv">length</span>
  <span class="p">(</span><span class="nf">wrap</span>
    <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">xs</span><span class="p">]</span> <span class="nv">_</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span>
          <span class="mi">0</span>
          <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct an operative</span>
<span class="c1">;</span>
<span class="c1">; An operative is a combiner that is called with unevaluated arguments and the</span>
<span class="c1">; caller&#39;s dynamic scope.</span>
<span class="c1">;</span>
<span class="c1">; Operatives are used to define new syntactic constructs.</span>
<span class="p">(</span><span class="k">def </span><span class="nv">op</span>
  <span class="p">(</span><span class="p">(</span><span class="nf">wrap</span>
     <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="nf">op</span><span class="p">)</span> <span class="nv">_</span>
         <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
           <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span>
                  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">length</span> <span class="nv">body</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">(</span><span class="nb">cons </span><span class="k">do </span><span class="nv">body</span><span class="p">)</span>
                    <span class="p">(</span><span class="nb">first </span><span class="nv">body</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
                 <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
   <span class="nv">op</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct an operative and bind it to a symbol</span>
<span class="c1">;</span>
<span class="c1">; Returns the bound symbol. Write a comment before (defop) to provide</span>
<span class="c1">; documentation.</span>
<span class="p">(</span><span class="k">def </span><span class="nv">defop</span>
  <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct a function</span>
<span class="c1">;</span>
<span class="c1">; Functions are applicative combiners which evaluate their arguments before</span>
<span class="c1">; passing them to an underlying operative.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="k">fn </span><span class="p">[</span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">_</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct a function and bind it to a symbol</span>
<span class="c1">;</span>
<span class="c1">; Returns the bound symbol. Write a comment before (defn) to provide</span>
<span class="c1">; documentation.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="kd">defn </span><span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="k">fn </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the second member of a linked list</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">second </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span>   <span class="nv">x</span><span class="p">)</span>

<span class="c1">; return third member of a linked list</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">third</span>  <span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span>

<span class="c1">; return the current scope</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nv">get-current-scope</span> <span class="nv">_</span> <span class="nv">scope</span> <span class="nv">scope</span><span class="p">)</span>

<span class="c1">; returns the unevaluated form</span>
<span class="p">(</span><span class="nf">defop</span> <span class="k">quote </span><span class="p">[</span><span class="nv">form</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">form</span><span class="p">)</span>

<span class="c1">; returns a list containing the result of applying f to each member of xs</span>
<span class="p">(</span><span class="k">def </span><span class="nv">map</span>
  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span>
      <span class="p">(</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">map </span><span class="nv">f</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; calls a function with alternating pairs in a flat list (i.e. with pairs ungrouped)</span>
<span class="c1">;</span>
<span class="c1">; Takes 2-arity function and a flat pair sequence. Walks the sequence and calls</span>
<span class="c1">; f with 2 values at a time.</span>
<span class="c1">;</span>
<span class="c1">; Raises an error if the list has uneven length.</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (map-pairs cons [:a 1 :b 2 :c 3])</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">map-pairs</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">ps</span><span class="p">]</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">map-pairs-acc</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">a</span> <span class="nv">ps</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">ps</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="p">[</span><span class="p">]</span>
        <span class="p">(</span><span class="nf">error</span> <span class="s">&#34;syntax: uneven pairs&#34;</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="nv">ps</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; binds values in a child scope</span>
<span class="c1">;</span>
<span class="c1">; Takes a flat pair sequence alternating bindings and their values. Binds</span>
<span class="c1">; and evaluates each value in sequence, allowing later bindings to refer to</span>
<span class="c1">; earlier bindings.</span>
<span class="c1">;</span>
<span class="c1">; Returns the result of evaluating the body in the child scope.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="k">let </span><span class="p">(</span><span class="nf">bindings</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">child</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">map-pairs</span>
    <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span>
      <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span>
    <span class="nv">bindings</span><span class="p">)</span>

  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; provide bindings to the current scope from a nested scope</span>
<span class="c1">;</span>
<span class="c1">; Allows for modularity in code, selectively providing bindings while</span>
<span class="c1">; encapsulating bindings that they use.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nv">provide</span> <span class="p">[</span><span class="nv">symbols</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">inner</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">map</span>
      <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">sym</span><span class="p">]</span>
        <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">val </span><span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span>
              <span class="nv">com</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">commentary</span> <span class="nv">sym</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">comment </span><span class="p">[</span><span class="k">def </span><span class="nv">sym</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span> <span class="nv">com</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span>
          <span class="nv">sym</span><span class="p">)</span><span class="p">)</span>
      <span class="nv">symbols</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; binds symbols to values in the target scope</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nv">set!</span> <span class="p">[</span><span class="nv">target</span> <span class="nv">symbols</span> <span class="nv">values</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nv">symbols</span> <span class="p">[</span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">eval</span><span class="p">)</span> <span class="nv">values</span> <span class="nv">scope</span><span class="p">]</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">eval </span><span class="nv">target</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; binds symbols in the current scope to their values from the source</span>
<span class="c1">; scope</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nb">import </span><span class="p">[</span><span class="nv">source</span> <span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">set!</span> <span class="nv">scope</span> <span class="nv">symbols</span> <span class="p">[</span><span class="nb">list </span><span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">eval </span><span class="nv">source</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">[</span><span class="nv">cond</span><span class="p">]</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">cond-pairs</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">a</span> <span class="nv">ps</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">ps</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="nv">null</span>
        <span class="nv">uneven-pairs</span><span class="p">)</span> <span class="c1">; TODO: proper error</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">cond-pairs</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">do</span>
          <span class="p">(</span><span class="k">def </span><span class="p">(</span><span class="nf">ok</span> <span class="o">&amp;</span> <span class="nv">res</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
          <span class="p">(</span><span class="k">if </span><span class="nv">ok</span>
            <span class="nv">res</span>
            <span class="p">(</span><span class="nf">cond-pairs</span> <span class="nv">f</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; if-then-else with many clauses</span>
  <span class="c1">;</span>
  <span class="c1">; Takes a flat pair sequence alternating tests to evaluate and an</span>
  <span class="c1">; expression to evaluate if the test returns a truthy value.</span>
  <span class="c1">;</span>
  <span class="c1">; Returns the result of the evaluated branch, or null if no tests were true.</span>
  <span class="c1">;</span>
  <span class="c1">; By convention, :else is used as the final catch-all test, though any</span>
  <span class="c1">; truthy value works.</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nb">cond </span><span class="nv">clauses</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="nf">cond-pairs</span>
      <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">test </span><span class="nv">body</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eval </span><span class="nb">test </span><span class="nv">scope</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cons </span><span class="nv">true</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">body</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cons </span><span class="nv">false</span> <span class="nv">null</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
      <span class="nv">null</span>
      <span class="nv">clauses</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; lazily evaluated boolean &#39;or&#39;</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nb">or </span><span class="nv">conds</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nf">cond</span>
    <span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span>
      <span class="nv">false</span>

    <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span>

    <span class="ss">:else</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span>
            <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="nv">xv</span>
          <span class="nv">xv</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">or </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; lazily evaluated boolean &#39;and&#39;</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nb">and </span><span class="nv">conds</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nf">cond</span>
    <span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span>
      <span class="nv">true</span>

    <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span>

    <span class="ss">:else</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span>
            <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="nv">xv</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">and </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span>
          <span class="nv">xv</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; call an applicative&#39;s underlying operative with a list of arguments</span>
<span class="c1">;</span>
<span class="c1">; A scope may be provided as the third argument. If not specified, the</span>
<span class="c1">; operative will be called in a new empty scope.</span>
<span class="c1">;</span>
<span class="c1">; Used to call an applicative with pre-evaluated arguments, skipping the normal</span>
<span class="c1">; evaluation the applicative would perform prior to calling the underlying</span>
<span class="c1">; operative.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">apply </span><span class="p">[</span><span class="nv">appv</span> <span class="nv">arg</span> <span class="o">&amp;</span> <span class="nv">opt</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">appv</span><span class="p">)</span> <span class="nv">arg</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">opt</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">make-scope</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">first </span><span class="nv">opt</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">-&gt;</span><span class="p">)</span>
  <span class="c1">; threads a value through forms</span>
  <span class="c1">;</span>
  <span class="c1">; Calls the first form with the given value, passing the result to the second</span>
  <span class="c1">; form, and so on, returning the final value.</span>
  <span class="c1">;</span>
  <span class="c1">; A form may be a list or a single value. For a list, the value is inserted</span>
  <span class="c1">; before the second value, becoming the first argument. For a single value,</span>
  <span class="c1">; it is wrapped in a list with the value as the single argument.</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nb">-&gt; </span><span class="p">[</span><span class="nv">x</span> <span class="nv">f</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">v</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">pair?</span> <span class="nv">f</span><span class="p">)</span>
              <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">f</span><span class="o">&#39;</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">)</span> <span class="nv">f</span><span class="p">]</span>
                <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span><span class="o">&#39;</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span> <span class="nv">x</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">fs</span><span class="p">)</span>
        <span class="nv">v</span>
        <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">-&gt; </span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">case</span><span class="p">)</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">case-branches</span> <span class="p">[</span><span class="nv">scope</span> <span class="nb">val </span><span class="nv">branches</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">branches</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">errorf</span> <span class="s">&#34;no matching case branch: %s&#34;</span> <span class="nv">val</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">[</span><span class="nv">pattern</span> <span class="nv">expr</span> <span class="o">&amp;</span> <span class="nv">rest</span><span class="p">]</span> <span class="nv">branches</span>
            <span class="nv">child</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">bind</span> <span class="nv">child</span> <span class="nv">pattern</span> <span class="nv">val</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">eval </span><span class="nv">expr</span> <span class="nv">child</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">case-branches</span> <span class="nv">scope</span> <span class="nb">val </span><span class="nv">rest</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; evaluates the branch that successfully binds the given value</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nv">case</span> <span class="p">[</span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">bs</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="nf">case-branches</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">v</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">bs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; identity function; returns its argument</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">id</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">93</span> <span class="mi">109</span> <span class="mi">196</span> <span class="mi">160</span> <span class="mi">158</span> <span class="mi">133</span> <span class="mi">79</span> <span class="mi">28</span> <span class="mi">134</span> <span class="mi">70</span> <span class="mi">184</span> <span class="mi">230</span> <span class="mi">180</span> <span class="mi">153</span> <span class="mi">247</span> <span class="mi">197</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">run.bass</span> <span class="c1">; returns a structure which will join the given values into a single string value</span>
<span class="c1">;</span>
<span class="c1">; Used to concatenate paths with string values to be passed as an argument to a</span>
<span class="c1">; workload.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">arg</span> <span class="nv">vals</span>
  <span class="p">{</span><span class="ss">:arg</span> <span class="nv">vals</span><span class="p">}</span><span class="p">)</span>

<span class="c1">; sets the :args field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-args</span> <span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:args</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :stdin field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-stdin</span> <span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">stdin</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:stdin</span> <span class="nv">stdin</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :entrypoint field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-entrypoint</span> <span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">entrypoint</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:entrypoint</span> <span class="nv">entrypoint</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :insecure field of the workload to true</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">insecure!</span> <span class="p">[</span><span class="nv">workload</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">with-insecure</span> <span class="nv">workload</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :insecure field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-insecure</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">val</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:insecure</span> <span class="nv">val</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">$</span><span class="p">)</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">resolve-arg</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">scope</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">symbol? </span><span class="nv">a</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">word</span> <span class="p">(</span><span class="nf">symbol-&gt;string</span> <span class="nv">a</span><span class="p">)</span>
            <span class="nv">start</span> <span class="p">(</span><span class="nf">substring</span> <span class="nv">word</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">start</span> <span class="s">&#34;$&#34;</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="p">(</span><span class="nf">substring</span> <span class="nv">word</span> <span class="mi">1</span><span class="p">)</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span>
          <span class="nv">word</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval </span><span class="nv">a</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; constructs a workload with args set as :args</span>
  <span class="c1">;</span>
  <span class="c1">; Symbol arguments are automatically converted to strings. Symbols beginning</span>
  <span class="c1">; with $ are resolved to their binding with the leading $ removed.</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nv">$</span> <span class="p">[</span><span class="nv">cmd</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="c1">; TODO: check pair? args; could be splatted</span>
    <span class="c1">;</span>
    <span class="c1">; in fact, check if a trailing splat arg even works properly here?</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">as</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">resolve-arg</span> <span class="nv">a</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="nv">args</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="nb">apply </span><span class="nv">with-args</span> <span class="p">[</span><span class="p">(</span><span class="p">(</span><span class="nb">eval </span><span class="nv">cmd</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="k">def </span><span class="nv">linux</span>
  <span class="p">{</span><span class="ss">:os</span> <span class="s">&#34;linux&#34;</span><span class="p">}</span><span class="p">)</span>

<span class="p">(</span><span class="k">def </span><span class="nv">windows</span>
  <span class="p">{</span><span class="ss">:os</span> <span class="s">&#34;windows&#34;</span><span class="p">}</span><span class="p">)</span>

<span class="p">(</span><span class="k">def </span><span class="nv">darwin</span>
  <span class="p">{</span><span class="ss">:os</span> <span class="s">&#34;darwin&#34;</span><span class="p">}</span><span class="p">)</span>

<span class="c1">; the default platform for workloads that configure an image</span>
<span class="p">(</span><span class="k">def </span><span class="nv">*default-platform*</span>
  <span class="nv">linux</span><span class="p">)</span>

<span class="c1">; sets the :image field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">in-image</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">image</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span>
         <span class="ss">:image</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">string? </span><span class="nv">image</span><span class="p">)</span>
                  <span class="p">{</span><span class="ss">:repository</span> <span class="nv">image</span><span class="p">}</span>
                  <span class="nv">image</span><span class="p">)</span>
         <span class="ss">:platform</span> <span class="p">(</span><span class="ss">:platform</span> <span class="nv">workload</span> <span class="nv">*default-platform*</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :platform field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">on-platform</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">platform</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:platform</span> <span class="nv">platform</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :response field of the workload</span>
<span class="c1">;</span>
<span class="c1">; If source is :stdout, sets it to {:stdout true}.</span>
<span class="c1">; If source is :exit, sets it to {:exit-code true}.</span>
<span class="c1">; If source is a path?, sets it to {:file source}.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">response-from</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span>
         <span class="ss">:response</span>
         <span class="p">(</span><span class="nf">cond</span>
           <span class="p">(</span><span class="nb">= </span><span class="ss">:stdin</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:stdout</span> <span class="nv">true</span><span class="p">}</span>
           <span class="p">(</span><span class="nb">= </span><span class="ss">:exit</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:exit-code</span> <span class="nv">true</span><span class="p">}</span>
           <span class="p">(</span><span class="nf">path?</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:file</span> <span class="nv">source</span><span class="p">}</span>
           <span class="ss">:else</span> <span class="nv">unknown-response</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :dir field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">in-dir</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">dir</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:dir</span> <span class="nv">dir</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; appends a mount to the :mounts field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-mount</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span> <span class="nv">target</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">cur</span> <span class="p">(</span><span class="ss">:mounts</span> <span class="nv">workload</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span>
           <span class="ss">:mounts</span>
           <span class="p">(</span><span class="nb">conj </span><span class="nv">cur</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:target</span> <span class="nv">target</span><span class="p">}</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :mounts field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-mounts</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">mounts</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:mounts</span> <span class="nv">mounts</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; inserts an env var and value into the :env field of the workload</span>
<span class="c1">;</span>
<span class="c1">; TODO: append, add in stable order</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-env-var</span> <span class="p">[</span><span class="nv">workload</span> <span class="nb">name </span><span class="nv">value</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:env</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">name </span><span class="nv">value</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :env field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-env</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">env</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="nv">env</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; attaches metadata to the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">with-meta </span><span class="p">[</span><span class="nv">workload</span> <span class="nb">key </span><span class="nv">val</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:meta</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:meta</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">key </span><span class="nv">val</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">64</span> <span class="mi">106</span> <span class="mi">99</span> <span class="mi">121</span> <span class="mi">180</span> <span class="mi">114</span> <span class="mi">34</span> <span class="mi">166</span> <span class="mi">165</span> <span class="mi">102</span> <span class="mi">139</span> <span class="mi">99</span> <span class="mi">230</span> <span class="mi">100</span> <span class="mi">1</span> <span class="mi">52</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">streams.bass</span> <span class="c1">; returns the last value from the stream</span>
<span class="c1">;</span>
<span class="c1">; As with (next), a default may be provided to be returned when the stream is</span>
<span class="c1">; empty. If not provided, an error will be raised if the stream is empty.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">last </span><span class="p">[</span><span class="nv">stream</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">default</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span><span class="p">)</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">do</span>
      <span class="p">(</span><span class="k">def </span><span class="nv">v</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">v</span> <span class="ss">:end</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">first </span><span class="nv">default</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="nv">v</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; calls f for every value read from the stream</span>
<span class="c1">;</span>
<span class="c1">; Returns null.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">each</span> <span class="p">[</span><span class="nv">stream</span> <span class="nv">f</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">n</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="ss">:end</span><span class="p">)</span>
      <span class="nv">null</span>
      <span class="p">(</span><span class="nf">do</span>
        <span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">each</span> <span class="nv">stream</span> <span class="nv">f</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">17</span> <span class="mi">21</span> <span class="mi">240</span> <span class="mi">146</span> <span class="mi">22</span> <span class="mi">151</span> <span class="mi">124</span> <span class="mi">1</span> <span class="mi">215</span> <span class="mi">206</span> <span class="mi">171</span> <span class="mi">189</span> <span class="mi">103</span> <span class="mi">107</span> <span class="mi">128</span> <span class="mi">78</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">strings.bass</span> <span class="c1">; joins a list of strings together with delim in between</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">join </span><span class="p">[</span><span class="nv">delim</span> <span class="nv">strs</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">case</span> <span class="nv">strs</span>
    <span class="p">[</span><span class="p">]</span> <span class="s">&#34;&#34;</span>
    <span class="p">[</span><span class="nv">s</span><span class="p">]</span> <span class="nv">s</span>
    <span class="p">[</span><span class="nv">s</span> <span class="o">&amp;</span> <span class="nv">ss</span><span class="p">]</span> <span class="p">(</span><span class="nb">str </span><span class="nv">s</span> <span class="nv">delim</span> <span class="p">(</span><span class="nb">join </span><span class="nv">delim</span> <span class="nv">ss</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">110</span> <span class="mi">93</span> <span class="mi">14</span> <span class="mi">96</span> <span class="mi">5</span> <span class="mi">77</span> <span class="mi">37</span> <span class="mi">44</span> <span class="mi">139</span> <span class="mi">78</span> <span class="mi">174</span> <span class="mi">177</span> <span class="mi">106</span> <span class="mi">61</span> <span class="mi">232</span> <span class="mi">101</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">yaml.bass</span> <span class="c1">; decodes the YAML content of the given file</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">decode</span> <span class="p">[</span><span class="nv">path</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">yaml-decode</span> <span class="nv">path</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">210</span> <span class="mi">211</span> <span class="mi">230</span> <span class="mi">233</span> <span class="mi">94</span> <span class="mi">154</span> <span class="mi">240</span> <span class="mi">243</span> <span class="mi">234</span> <span class="mi">249</span> <span class="mi">53</span> <span class="mi">185</span> <span class="mi">81</span> <span class="mi">143</span> <span class="mi">135</span> <span class="mi">92</span><span class="p">]</span><span class="p">}</span><span class="p">]</span><span class="p">)</span><span class="p">}</span><span class="nv">/</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*stdin*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;source</span><span class="err">:</span> <span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*stdout*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;sink</span><span class="err">:</span> <span class="nv">&lt;workload</span><span class="err">:</span> <span class="mi">9</span><span class="nv">bd3b8606144f1b30c031e9fa327879b0bd32959&gt;&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">+</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">+ </span><span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">-</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">- </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">-&gt;</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">f</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">v</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">pair?</span> <span class="nv">f</span><span class="p">)</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">f</span><span class="o">&#39;</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">)</span> <span class="nv">f</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span><span class="o">&#39;</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span> <span class="nv">x</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">fs</span><span class="p">)</span> <span class="nv">v</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">-&gt; </span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;=</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&lt;= </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">=</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">= </span><span class="nb">val </span><span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&gt;</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&gt; </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&gt;=</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&gt;= </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">and</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">conds</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span> <span class="nv">true</span> <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span> <span class="ss">:else</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span> <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">and </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">xv</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">append</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nv">xss</span> <span class="p">(</span><span class="nf">foldl</span> <span class="nv">append1</span> <span class="p">(</span><span class="p">)</span> <span class="nv">xss</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">applicative?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">applicative?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">apply</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">appv</span> <span class="nv">arg</span> <span class="o">&amp;</span> <span class="nv">opt</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">appv</span><span class="p">)</span> <span class="nv">arg</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">opt</span><span class="p">)</span> <span class="p">(</span><span class="nf">make-scope</span><span class="p">)</span> <span class="p">(</span><span class="nb">first </span><span class="nv">opt</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">arg</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nb">vals </span><span class="p">{</span><span class="ss">:arg</span> <span class="nv">vals</span><span class="p">}</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">assoc</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">obj</span> <span class="o">&amp;</span> <span class="nv">kvs</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">bind</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">bind</span> <span class="nv">scope</span> <span class="nv">formals</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">boolean?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">boolean?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">case</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">bs</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">case-branches</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">v</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">bs</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">combiner?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">combiner?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">comment</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">comment </span><span class="nv">form</span> <span class="nv">annotated</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">commentary</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">commentary</span> <span class="nv">sym</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">cond</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">clauses</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">cond-pairs</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">test </span><span class="nv">body</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eval </span><span class="nb">test </span><span class="nv">scope</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">true</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">body</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">false</span> <span class="nv">null</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="nv">null</span> <span class="nv">clauses</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">conj</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">xs</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span> <span class="p">[</span><span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span> <span class="p">(</span><span class="nb">conj </span><span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">cons</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">a</span> <span class="nv">d</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">darwin</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;darwin&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">def</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">def </span><span class="nb">binding </span><span class="nv">value</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">defn</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="k">fn </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">defop</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">do</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">doc</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">doc </span><span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">dump</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">dump</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">each</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">stream</span> <span class="nv">f</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">n</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="ss">:end</span><span class="p">)</span> <span class="nv">null</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">each</span> <span class="nv">stream</span> <span class="nv">f</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">emit</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">emit</span> <span class="nb">val </span><span class="nv">sink</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">empty?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">empty?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">error</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">error</span> <span class="nv">msg</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">errorf</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">errorf</span> <span class="nv">fmt</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">eval</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">form</span> <span class="nv">scope</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">filter</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">append</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">first</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">f</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">f</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">fn</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">_</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">foldl</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span> <span class="p">(</span><span class="p">)</span> <span class="nv">z</span> <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">foldl</span> <span class="nv">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">z</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">foldr</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span> <span class="p">(</span><span class="p">)</span> <span class="nv">z</span> <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">foldr</span> <span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">get-current-scope</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">_</span> <span class="nv">scope</span> <span class="nv">scope</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">ground</span></code></div>
        
        <div class="object-cell">ground</div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">id</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">if</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">if </span><span class="nb">cond </span><span class="nv">yes</span> <span class="nv">no</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">ignore?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">ignore?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">import</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">source</span> <span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">set!</span> <span class="nv">scope</span> <span class="nv">symbols</span> <span class="p">[</span><span class="nb">list </span><span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">source</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">in-dir</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">dir</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:dir</span> <span class="nv">dir</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">in-image</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">image</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:image</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">string? </span><span class="nv">image</span><span class="p">)</span> <span class="p">{</span><span class="ss">:repository</span> <span class="nv">image</span><span class="p">}</span> <span class="nv">image</span><span class="p">)</span> <span class="ss">:platform</span> <span class="p">(</span><span class="ss">:platform</span> <span class="nv">workload</span> <span class="nv">*default-platform*</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">insecure!</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span><span class="p">]</span> <span class="p">(</span><span class="nf">with-insecure</span> <span class="nv">workload</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">join</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">delim</span> <span class="nv">strs</span><span class="p">]</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">strs</span> <span class="p">(</span><span class="p">)</span> <span class="s">&#34;&#34;</span> <span class="p">[</span><span class="nv">s</span><span class="p">]</span> <span class="nv">s</span> <span class="p">[</span><span class="nv">s</span> <span class="o">&amp;</span> <span class="nv">ss</span><span class="p">]</span> <span class="p">(</span><span class="nb">str </span><span class="nv">s</span> <span class="nv">delim</span> <span class="p">(</span><span class="nb">join </span><span class="nv">delim</span> <span class="nv">ss</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">last</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">stream</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">default</span><span class="p">)</span> <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="k">def </span><span class="nv">v</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">v</span> <span class="ss">:end</span><span class="p">)</span> <span class="p">(</span><span class="nb">first </span><span class="nv">default</span><span class="p">)</span> <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="nv">v</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">length</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">let</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="nf">bindings</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span><span class="nb">&gt; </span><span class="p">(</span><span class="k">def </span><span class="nv">child</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span> <span class="nv">bindings</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">linux</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;linux&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nv">values</span> <span class="nv">values</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nv">args</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="k">def </span><span class="nv">aux</span> <span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="p">(</span><span class="nf">head</span> <span class="o">&amp;</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span> <span class="nv">_</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">tail</span><span class="p">)</span> <span class="nv">head</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">head</span> <span class="p">(</span><span class="nf">aux</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">aux</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list-&gt;scope</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">kwargs</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">{</span><span class="p">}</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">list?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">load</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">load </span><span class="nv">workload</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">log</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">log</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">logf</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">logf</span> <span class="nv">fmt</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">make-scope</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="o">&amp;</span> <span class="nv">parents</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">map</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span> <span class="p">(</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">map </span><span class="nv">f</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">map-pairs</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">ps</span><span class="p">]</span> <span class="p">(</span><span class="nf">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span><span class="nb">&gt; </span><span class="p">(</span><span class="kd">defn </span><span class="nv">map-pairs-acc</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">a</span> <span class="nv">ps</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="p">)</span> <span class="p">(</span><span class="nf">error</span> <span class="s">&#34;syntax: uneven pairs&#34;</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">max</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">max </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">merge</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">obj</span> <span class="o">&amp;</span> <span class="nv">objs</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">min</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">min </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">next</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">next </span><span class="nv">src</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">not</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="nv">x</span> <span class="nv">false</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">now</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">now</span> <span class="nv">duration</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">null?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">null?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">number?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">number?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">on-platform</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">platform</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:platform</span> <span class="nv">platform</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">op</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">length</span> <span class="nv">body</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="k">do </span><span class="nv">body</span><span class="p">)</span> <span class="p">(</span><span class="nb">first </span><span class="nv">body</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">operative?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">operative?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">or</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">conds</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span> <span class="nv">false</span> <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span> <span class="ss">:else</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span> <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="nv">xv</span> <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">or </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">pair?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">pair?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">path</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">path </span><span class="nv">workload</span> <span class="nv">path</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">path?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">path?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">provide</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">symbols</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">inner</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">sym</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">val </span><span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span> <span class="nv">com</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">commentary</span> <span class="nv">sym</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">comment </span><span class="p">[</span><span class="k">def </span><span class="nv">sym</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span> <span class="nv">com</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">sym</span><span class="p">)</span><span class="p">)</span> <span class="nv">symbols</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">quote</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">form</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">form</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">reduce-kv</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">reduce-kv</span> <span class="nv">f</span> <span class="nv">init</span> <span class="nv">kv</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">response-from</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:response</span> <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nb">= </span><span class="ss">:stdin</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:stdout</span> <span class="nv">true</span><span class="p">}</span> <span class="p">(</span><span class="nb">= </span><span class="ss">:exit</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:exit-code</span> <span class="nv">true</span><span class="p">}</span> <span class="p">(</span><span class="nf">path?</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:file</span> <span class="nv">source</span><span class="p">}</span> <span class="ss">:else</span> <span class="nv">unknown-response</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">rest</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="o">&amp;</span> <span class="nv">r</span><span class="p">)</span><span class="p">]</span> <span class="nv">r</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">run</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">run</span> <span class="nv">workload</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">scope-&gt;list</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">scope-&gt;list</span> <span class="nv">obj</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">scope?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">scope?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">second</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">set!</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">target</span> <span class="nv">symbols</span> <span class="nv">values</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nv">symbols</span> <span class="p">[</span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">eval</span><span class="p">)</span> <span class="nv">values</span> <span class="nv">scope</span><span class="p">]</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">target</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">sink?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">sink?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">source?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">source?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">str</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">str </span><span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">stream</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">stream</span> <span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;dir</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;dir</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;path</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;path</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;run-path</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;run-path</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;symbol</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">string? </span><span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">substring</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">substring</span> <span class="nb">str </span><span class="nv">start</span> <span class="o">&amp;</span> <span class="nv">end</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">symbol-&gt;string</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">symbol-&gt;string</span> <span class="nv">sym</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">symbol?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">symbol? </span><span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">third</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">time</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">time </span><span class="nv">form</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">unwrap</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">unwrap</span> <span class="nv">app</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">windows</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;windows&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-args</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:args</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-entrypoint</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">entrypoint</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:entrypoint</span> <span class="nv">entrypoint</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-env</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">env</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="nv">env</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-env-var</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nb">name </span><span class="nv">value</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:env</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">name </span><span class="nv">value</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-insecure</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">val</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:insecure</span> <span class="nv">val</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-meta</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nb">key </span><span class="nv">val</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:meta</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:meta</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">key </span><span class="nv">val</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-mount</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span> <span class="nv">target</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">cur</span> <span class="p">(</span><span class="ss">:mounts</span> <span class="nv">workload</span> <span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:mounts</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">cur</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:target</span> <span class="nv">target</span><span class="p">}</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-mounts</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">mounts</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:mounts</span> <span class="nv">mounts</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-stdin</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">stdin</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:stdin</span> <span class="nv">stdin</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">wrap</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">wrap</span> <span class="nv">comb</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">yaml-decode</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">yaml-decode</span> <span class="nv">workload-path</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div>
    </div>
  </div>

</div><div class="bass-commentary">
  <div class="bass-binding"><a id="join"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/strings.bass#L2-L6">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nb">join </span><span class="nv">delim</span> <span class="nv">strs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>joins a list of strings together with delim in between</p></div>
  </div>
  
</div>
</div>


  

  
    <h2 class="section-header highlight chroma"><a id="concourse"></a>
  <span class="c1"><a class="section-anchor" href="stdlib.html#concourse"></a>Concourse</span>
</h2>

<div class="code-with-output">
  <div class="section code">
    <code class="highlight chroma"><span class="p">(</span><span class="nb">load </span><span class="p">(</span><span class="nf">.concourse</span><span class="p">)</span><span class="p">)</span></code>
  </div>


  <div class="section stderr">
    <span class="section-label">stderr</span>

    <pre><div class="ansi-line"><span class="fg-magenta ">debug</span><span class=" ">	loading workload	{&#34;workload&#34;: &#34;e5127b2fb0a6aa915b32dd6807dd3fa285ae7168&#34;, &#34;path&#34;: &#34;.concourse&#34;}</span></div><div class="ansi-line"><span class="fg-magenta ">debug</span><span class=" ">	loading workload	{&#34;workload&#34;: &#34;65b59576074683784cbe798a9dbb4f20f1526520&#34;, &#34;path&#34;: &#34;.durations&#34;}</span></div><div class="ansi-line"><span class="fg-magenta ">debug</span><span class=" ">	loading workload	{&#34;workload&#34;: &#34;f5a12ef6a0fb81a1896ff193c4f6f4308f5b2e13&#34;, &#34;path&#34;: &#34;.yaml&#34;}</span></div></pre>
  </div>





  <div class="section result">
    <span class="section-label">result</span>
    <div class="bass-value">
      <div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">$</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">cmd</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">as</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">resolve-arg</span> <span class="nv">a</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="nv">args</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">with-args</span> <span class="p">[</span><span class="p">(</span><span class="p">(</span><span class="nb">eval </span><span class="nv">cmd</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">* </span><span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*args*</span></code></div>
        
        <div class="object-cell"><div class="delimited">
  <div class="open"><code class="chroma p">(</code></div>
  <div class="content">
    <ol class="bass-list">
    
    </ol>
  </div>
  <div class="close"><code class="chroma p">)</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*default-config*</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">check-interval</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">3600</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">image-check-interval</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">86400</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">platforms</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">linux</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;linux&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">types</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">docker-image</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/docker-image-resource&#34;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">git</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/git-resource&#34;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">registry-image</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/registry-image-resource&#34;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">time</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/time-resource&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*default-platform*</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;linux&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*dir*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">{</span><span class="nv">%!s</span><span class="p">(</span><span class="nf">*</span><span class="p">[</span><span class="p">]</span><span class="nv">embed.file=</span><span class="o">&amp;</span><span class="p">[</span><span class="p">{</span><span class="nv">bool.bass</span> <span class="c1">; negates the given bool-ish value</span>
<span class="c1">;</span>
<span class="c1">; Returns true for false and null. Returns false otherwise.</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (not true)</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (not null)</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (not false)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">not </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span>
	<span class="p">(</span><span class="k">if </span><span class="nv">x</span> <span class="nv">false</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">140</span> <span class="mi">74</span> <span class="mi">29</span> <span class="mi">144</span> <span class="mi">51</span> <span class="mi">132</span> <span class="mi">198</span> <span class="mi">144</span> <span class="mi">159</span> <span class="mi">72</span> <span class="mi">240</span> <span class="mi">110</span> <span class="mi">160</span> <span class="mi">202</span> <span class="mi">22</span> <span class="mi">157</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">concourse.bass</span> <span class="p">(</span><span class="nf">provide</span>
  <span class="p">[</span>
   <span class="nv">*default-config*</span>

   <span class="nv">resource</span>
   <span class="nv">get-latest</span>

   <span class="nv">run-task</span>

   <span class="nv">get-image-resource</span>
   <span class="nv">get-latest-image-resource</span>
  <span class="p">]</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">dur</span> <span class="p">(</span><span class="nb">load </span><span class="p">(</span><span class="nf">.durations</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; a convenient mapping from type keywords to their image</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">*core-types*</span>
    <span class="p">{</span><span class="ss">:registry-image</span> <span class="s">&#34;concourse/registry-image-resource&#34;</span>
     <span class="ss">:docker-image</span> <span class="s">&#34;concourse/docker-image-resource&#34;</span>
     <span class="ss">:git</span> <span class="s">&#34;concourse/git-resource&#34;</span>
     <span class="ss">:time</span> <span class="s">&#34;concourse/time-resource&#34;</span><span class="p">}</span><span class="p">)</span>

  <span class="c1">; the default configuration, if none is supplied on *stdin*</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">*default-config*</span>
    <span class="p">{</span><span class="ss">:platforms</span> <span class="p">{</span><span class="ss">:linux</span> <span class="nv">linux</span><span class="p">}</span>
     <span class="ss">:types</span> <span class="nv">*core-types*</span>
     <span class="ss">:check-interval</span> <span class="nv">dur</span><span class="ss">:hour</span>
     <span class="ss">:image-check-interval</span> <span class="nv">dur</span><span class="ss">:day</span><span class="p">}</span><span class="p">)</span>

  <span class="p">(</span><span class="k">def </span><span class="nv">*config*</span>
    <span class="p">(</span><span class="nb">merge </span><span class="nv">*default-config*</span> <span class="p">(</span><span class="nb">next </span><span class="nv">*stdin*</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; constructs a resource scope</span>
  <span class="c1">;</span>
  <span class="c1">; If type is a keyword, it is mapped to an image via :types in the module</span>
  <span class="c1">; configuration.</span>
  <span class="c1">;</span>
  <span class="c1">; Otherwise, it is passed along to `in-image`.</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">resource</span> <span class="p">[</span><span class="nv">type</span> <span class="nv">source</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">provide</span> <span class="p">[</span><span class="nv">check</span> <span class="nv">check-every</span> <span class="nb">get </span><span class="nv">put</span><span class="p">]</span>
      <span class="c1">; detect new versions of the resource with the default interval</span>
      <span class="c1">;</span>
      <span class="c1">; An optional cursor version to check from may be provided.</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nv">check</span> <span class="nv">optional-version</span>
        <span class="p">(</span><span class="nf">check-every</span> <span class="nv">*config*</span><span class="ss">:check-interval</span> <span class="o">&amp;</span> <span class="nv">optional-version</span><span class="p">)</span><span class="p">)</span>

      <span class="c1">; detect new versions of the resource with the given interval</span>
      <span class="c1">;</span>
      <span class="c1">; An optional cursor version to check from may be provided.</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nv">check-every</span> <span class="p">[</span><span class="nv">interval</span> <span class="o">&amp;</span> <span class="nv">optional-version</span><span class="p">]</span>
        <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">version</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">optional-version</span> <span class="p">[</span><span class="p">]</span> <span class="nv">null</span> <span class="p">(</span><span class="nf">v</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span> <span class="nv">v</span><span class="p">)</span><span class="p">]</span>
          <span class="p">(</span><span class="nb">apply </span><span class="nv">stream</span> <span class="p">(</span><span class="nb">next </span><span class="p">(</span><span class="nf">run</span> <span class="p">(</span><span class="nf">check-wl</span> <span class="nv">version</span> <span class="nv">interval</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="c1">; fetch a version of the resource</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nb">get </span><span class="p">[</span><span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">params</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">path </span><span class="p">(</span><span class="nf">get-wl</span> <span class="nv">version</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">params</span><span class="p">)</span><span class="p">)</span> <span class="nv">./</span><span class="p">)</span><span class="p">)</span>

      <span class="c1">; create or update a version of the resource</span>
      <span class="p">(</span><span class="kd">defn </span><span class="nv">put</span> <span class="nv">params</span>
        <span class="p">(</span><span class="nb">next </span><span class="p">(</span><span class="nf">run</span> <span class="p">(</span><span class="nf">put-wl</span> <span class="nv">version</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">params</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="k">def </span><span class="nv">image</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">symbol? </span><span class="nv">type</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">*config*</span> <span class="ss">:types</span> <span class="nv">type</span><span class="p">)</span>
          <span class="nv">type</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="kd">defn </span><span class="nv">check-wl</span> <span class="p">[</span><span class="nv">version</span> <span class="nv">interval</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/check</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:version</span> <span class="nv">version</span><span class="p">}</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">with-meta </span><span class="ss">:at</span> <span class="p">(</span><span class="nf">now</span> <span class="nv">interval</span><span class="p">)</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="kd">defn </span><span class="nv">get-wl</span> <span class="p">[</span><span class="nv">version</span> <span class="nv">params</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/in</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:version</span> <span class="nv">version</span> <span class="ss">:params</span> <span class="nv">params</span><span class="p">}</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">with-args</span> <span class="nv">./</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

      <span class="p">(</span><span class="kd">defn </span><span class="nv">put-wl</span> <span class="p">[</span><span class="nv">params</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/out</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:params</span> <span class="nv">params</span><span class="p">}</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">with-args</span> <span class="nv">./</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

    <span class="p">(</span><span class="nf">get-current-scope</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; gets the latest version of a resource</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">get-latest</span> <span class="p">[</span><span class="nv">r</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">r</span><span class="ss">:get</span> <span class="p">(</span><span class="nb">last </span><span class="p">(</span><span class="nf">r</span><span class="ss">:check</span><span class="p">)</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="k">def </span><span class="nv">yaml</span>
    <span class="p">(</span><span class="nb">load </span><span class="p">(</span><span class="nf">.yaml</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; run a task with the given parameters</span>
  <span class="c1">;</span>
  <span class="c1">; The :inputs param provides as a mapping from name to workload path.</span>
  <span class="c1">;</span>
  <span class="c1">; Returns an scope with :outputs bound to a mapping from name to workload</span>
  <span class="c1">; path, and :result bound to the workload&#39;s stream.</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">run-task</span> <span class="p">[</span><span class="nv">config-path</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">config</span> <span class="p">(</span><span class="nf">yaml</span><span class="ss">:decode</span> <span class="nv">config-path</span><span class="p">)</span>
          <span class="nv">opts</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">kwargs</span><span class="p">)</span>
          <span class="nv">workload</span> <span class="p">(</span><span class="nf">task-&gt;workload</span> <span class="nv">config</span> <span class="nv">opts</span><span class="p">)</span>

          <span class="nv">output-configs</span> <span class="p">(</span><span class="ss">:outputs</span> <span class="nv">config</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span>
          <span class="nv">output-pairs</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">output</span><span class="p">]</span>
                              <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">name </span><span class="p">(</span><span class="ss">:name</span> <span class="nv">output</span><span class="p">)</span>
                                    <span class="nv">src</span> <span class="p">(</span><span class="ss">:path</span> <span class="nv">output</span> <span class="nv">name</span><span class="p">)</span><span class="p">]</span>
                                <span class="p">[</span><span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">name</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nb">path </span><span class="nv">workload</span> <span class="p">(</span><span class="nf">string-&gt;dir</span> <span class="nv">src</span><span class="p">)</span><span class="p">)</span><span class="p">]</span><span class="p">)</span><span class="p">)</span>
                            <span class="nv">output-configs</span><span class="p">)</span>
          <span class="nv">outputs</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">append</span> <span class="nv">output-pairs</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
      <span class="p">{</span><span class="ss">:outputs</span> <span class="nv">outputs</span>
       <span class="ss">:result</span> <span class="p">(</span><span class="nf">run</span> <span class="nv">workload</span><span class="p">)</span><span class="p">}</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">task-&gt;workload</span> <span class="p">[</span><span class="nv">config</span> <span class="nv">opts</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">platform-name</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:platform</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">platform</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">*config*</span> <span class="ss">:platforms</span> <span class="nv">platform-name</span><span class="p">)</span>

          <span class="nv">image-type-name</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="ss">:type</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">image-type</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">*config*</span> <span class="ss">:types</span> <span class="nv">image-type-name</span><span class="p">)</span>
          <span class="nv">image-source</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="ss">:source</span><span class="p">)</span>
          <span class="nv">image-params</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="p">(</span><span class="ss">:params</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nv">scope-&gt;list</span><span class="p">)</span>
          <span class="nv">image-version</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:image-resource</span> <span class="p">(</span><span class="ss">:version</span> <span class="nv">null</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">image-resource</span> <span class="p">(</span><span class="nf">resource</span> <span class="nv">image-type</span> <span class="nv">image-source</span><span class="p">)</span>
          <span class="nv">image</span> <span class="p">(</span><span class="k">if </span><span class="nv">image-version</span>
                  <span class="p">(</span><span class="nf">get-image-resource</span> <span class="nv">image-resource</span> <span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">image-params</span><span class="p">)</span>
                  <span class="p">(</span><span class="nf">get-latest-image-resource</span> <span class="nv">image-resource</span> <span class="o">&amp;</span> <span class="nv">image-params</span><span class="p">)</span><span class="p">)</span>

          <span class="nv">run-path</span> <span class="p">(</span><span class="nf">string-&gt;path</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:run</span> <span class="ss">:path</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">run-args</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:run</span> <span class="p">(</span><span class="ss">:args</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span><span class="p">)</span>
          <span class="nv">run-dir</span> <span class="p">(</span><span class="nf">string-&gt;dir</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">config</span> <span class="ss">:run</span> <span class="p">(</span><span class="ss">:dir</span> <span class="s">&#34;.&#34;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

          <span class="nv">privileged</span> <span class="p">(</span><span class="ss">:privileged</span> <span class="nv">opts</span> <span class="nv">false</span><span class="p">)</span>

          <span class="nv">provided-inputs</span> <span class="p">(</span><span class="ss">:inputs</span> <span class="nv">opts</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span>
          <span class="nv">configured-inputs</span> <span class="p">(</span><span class="ss">:inputs</span> <span class="nv">config</span><span class="p">)</span>
          <span class="nv">mounts</span> <span class="p">(</span><span class="nb">filter </span><span class="nv">id</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">i</span><span class="p">]</span> <span class="p">(</span><span class="nf">input-mount</span> <span class="nv">provided-inputs</span> <span class="nv">i</span><span class="p">)</span><span class="p">)</span>
                                 <span class="nv">configured-inputs</span><span class="p">)</span><span class="p">)</span>

          <span class="nv">configured-params</span> <span class="p">(</span><span class="ss">:params</span> <span class="nv">config</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span>
          <span class="nv">provided-params</span> <span class="p">(</span><span class="ss">:params</span> <span class="nv">opts</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span>
          <span class="nv">env</span> <span class="p">(</span><span class="nf">reduce-kv</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">r</span> <span class="nv">k</span> <span class="nv">v</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">r</span> <span class="nv">k</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">v</span><span class="p">)</span> <span class="s">&#34;&#34;</span> <span class="nv">v</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
                         <span class="p">{</span><span class="p">}</span>
                         <span class="p">(</span><span class="nb">merge </span><span class="nv">configured-params</span> <span class="nv">provided-params</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">run-path</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-args</span> <span class="o">&amp;</span> <span class="nv">run-args</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">in-dir</span> <span class="nv">run-dir</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-mounts</span> <span class="nv">mounts</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-env</span> <span class="nv">env</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">on-platform</span> <span class="nv">platform</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">with-insecure</span> <span class="nv">privileged</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">response-from</span> <span class="ss">:exit</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">get-latest-image-resource</span> <span class="p">[</span><span class="nv">resource</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">check</span> <span class="p">(</span><span class="nf">resource</span><span class="ss">:check-every</span> <span class="nv">*config*</span><span class="ss">:image-check-interval</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="nf">get-image-resource</span> <span class="nv">resource</span> <span class="p">(</span><span class="nb">last </span><span class="nv">check</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">get-image-resource</span> <span class="p">[</span><span class="nv">resource</span> <span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">got</span> <span class="p">(</span><span class="nf">resource</span><span class="ss">:get</span> <span class="nv">version</span> <span class="ss">:format</span> <span class="s">&#34;oci&#34;</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">]</span>
      <span class="nv">got/image.tar</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">input-mount</span> <span class="p">[</span><span class="nv">inputs</span> <span class="nv">input</span><span class="p">]</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">name </span><span class="p">(</span><span class="ss">:name</span> <span class="nv">input</span><span class="p">)</span>
          <span class="nv">input-name</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">name</span><span class="p">)</span>
          <span class="nv">source</span> <span class="p">(</span><span class="nf">input-name</span> <span class="nv">inputs</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="k">if </span><span class="nv">source</span>
        <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span>
         <span class="ss">:target</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">input</span> <span class="p">(</span><span class="ss">:path</span> <span class="nv">name</span><span class="p">)</span> <span class="nv">string-&gt;dir</span><span class="p">)</span><span class="p">}</span>
        <span class="nv">null</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">71</span> <span class="mi">164</span> <span class="mi">246</span> <span class="mi">203</span> <span class="mi">11</span> <span class="mi">114</span> <span class="mi">12</span> <span class="mi">7</span> <span class="mi">215</span> <span class="mi">81</span> <span class="mi">55</span> <span class="mi">229</span> <span class="mi">94</span> <span class="mi">79</span> <span class="mi">249</span> <span class="mi">231</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">durations.bass</span> <span class="c1">; 60 seconds</span>
<span class="p">(</span><span class="k">def </span><span class="nv">minute</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1">; 60 minutes</span>
<span class="p">(</span><span class="k">def </span><span class="nv">hour</span> <span class="p">(</span><span class="nb">* </span><span class="nv">minute</span> <span class="mi">60</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 24 hours</span>
<span class="p">(</span><span class="k">def </span><span class="nv">day</span> <span class="p">(</span><span class="nb">* </span><span class="nv">hour</span> <span class="mi">24</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 7 days</span>
<span class="p">(</span><span class="k">def </span><span class="nv">week</span> <span class="p">(</span><span class="nb">* </span><span class="nv">day</span> <span class="mi">7</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 4 weeks</span>
<span class="p">(</span><span class="k">def </span><span class="nv">month</span> <span class="p">(</span><span class="nb">* </span><span class="nv">week</span> <span class="mi">4</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; 12 months</span>
<span class="p">(</span><span class="k">def </span><span class="nv">year</span> <span class="p">(</span><span class="nb">* </span><span class="nv">month</span> <span class="mi">12</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">118</span> <span class="mi">18</span> <span class="mi">128</span> <span class="mi">62</span> <span class="mi">139</span> <span class="mi">247</span> <span class="mi">192</span> <span class="mi">187</span> <span class="mi">75</span> <span class="mi">157</span> <span class="mi">209</span> <span class="mi">17</span> <span class="mi">237</span> <span class="mi">254</span> <span class="mi">217</span> <span class="mi">209</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">lists.bass</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">foldr</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span>
    <span class="p">[</span><span class="p">]</span> <span class="nv">z</span>
    <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">foldr</span> <span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">foldl</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span>
    <span class="p">[</span><span class="p">]</span> <span class="nv">z</span>
    <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">foldl</span> <span class="nv">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">z</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">append</span><span class="p">)</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">append1</span> <span class="p">[</span><span class="nv">xs</span> <span class="nv">ys</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span>
      <span class="p">[</span><span class="p">]</span> <span class="nv">ys</span>
      <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="p">(</span><span class="nf">append1</span> <span class="nv">xs</span><span class="o">&#39;</span> <span class="nv">ys</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">append</span> <span class="nv">xss</span>
    <span class="p">(</span><span class="nf">foldl</span> <span class="nv">append1</span> <span class="p">[</span><span class="p">]</span> <span class="nv">xss</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="kd">defn </span><span class="nb">filter </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">apply </span><span class="nv">append</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span><span class="p">)</span> <span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; conjoins values onto the end of a list</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">conj </span><span class="p">[</span><span class="nv">xs</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span>
    <span class="p">[</span><span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">conj </span><span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; constructs an object from a list of flat keyword/value pairs</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">list-&gt;scope</span> <span class="p">[</span><span class="nv">kwargs</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="p">{</span><span class="p">}</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">67</span> <span class="mi">174</span> <span class="mi">154</span> <span class="mi">224</span> <span class="mi">18</span> <span class="mi">178</span> <span class="mi">55</span> <span class="mi">101</span> <span class="mi">17</span> <span class="mi">216</span> <span class="mi">49</span> <span class="mi">236</span> <span class="mi">105</span> <span class="mi">164</span> <span class="mi">170</span> <span class="mi">86</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">root.bass</span> <span class="c1">; construct a list from a sequence of values</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (list 1 2 3)</span>
<span class="p">(</span><span class="k">def </span><span class="nb">list </span><span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="nv">values</span> <span class="nv">_</span> <span class="nv">values</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; prepend a sequence of values to a list given as the final argument</span>
<span class="p">(</span><span class="k">def </span><span class="nv">list*</span>
  <span class="p">(</span><span class="nf">wrap</span>
    <span class="p">(</span><span class="nf">op</span> <span class="nv">args</span> <span class="nv">_</span>
      <span class="p">(</span><span class="nf">do</span>
        <span class="p">(</span><span class="k">def </span><span class="nv">aux</span>
          <span class="p">(</span><span class="nf">wrap</span>
            <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="p">(</span><span class="nf">head</span> <span class="o">&amp;</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span> <span class="nv">_</span>
              <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">tail</span><span class="p">)</span>
                <span class="nv">head</span>
                <span class="p">(</span><span class="nb">cons </span><span class="nv">head</span> <span class="p">(</span><span class="nf">aux</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">aux</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the first value in a pair</span>
<span class="p">(</span><span class="k">def </span><span class="nb">first </span><span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="p">(</span><span class="nf">f</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">f</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the second value in a pair, i.e. the rest of a linked list</span>
<span class="p">(</span><span class="k">def </span><span class="nb">rest </span><span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="o">&amp;</span> <span class="nv">r</span><span class="p">)</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">r</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the length of the given list</span>
<span class="p">(</span><span class="k">def </span><span class="nv">length</span>
  <span class="p">(</span><span class="nf">wrap</span>
    <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">xs</span><span class="p">]</span> <span class="nv">_</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span>
          <span class="mi">0</span>
          <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct an operative</span>
<span class="c1">;</span>
<span class="c1">; An operative is a combiner that is called with unevaluated arguments and the</span>
<span class="c1">; caller&#39;s dynamic scope.</span>
<span class="c1">;</span>
<span class="c1">; Operatives are used to define new syntactic constructs.</span>
<span class="p">(</span><span class="k">def </span><span class="nv">op</span>
  <span class="p">(</span><span class="p">(</span><span class="nf">wrap</span>
     <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="nf">op</span><span class="p">)</span> <span class="nv">_</span>
         <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
           <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span>
                  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">length</span> <span class="nv">body</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">(</span><span class="nb">cons </span><span class="k">do </span><span class="nv">body</span><span class="p">)</span>
                    <span class="p">(</span><span class="nb">first </span><span class="nv">body</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
                 <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
   <span class="nv">op</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct an operative and bind it to a symbol</span>
<span class="c1">;</span>
<span class="c1">; Returns the bound symbol. Write a comment before (defop) to provide</span>
<span class="c1">; documentation.</span>
<span class="p">(</span><span class="k">def </span><span class="nv">defop</span>
  <span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct a function</span>
<span class="c1">;</span>
<span class="c1">; Functions are applicative combiners which evaluate their arguments before</span>
<span class="c1">; passing them to an underlying operative.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="k">fn </span><span class="p">[</span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">_</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; construct a function and bind it to a symbol</span>
<span class="c1">;</span>
<span class="c1">; Returns the bound symbol. Write a comment before (defn) to provide</span>
<span class="c1">; documentation.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="kd">defn </span><span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="k">fn </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; return the second member of a linked list</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">second </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span>   <span class="nv">x</span><span class="p">)</span>

<span class="c1">; return third member of a linked list</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">third</span>  <span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span>

<span class="c1">; return the current scope</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nv">get-current-scope</span> <span class="nv">_</span> <span class="nv">scope</span> <span class="nv">scope</span><span class="p">)</span>

<span class="c1">; returns the unevaluated form</span>
<span class="p">(</span><span class="nf">defop</span> <span class="k">quote </span><span class="p">[</span><span class="nv">form</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">form</span><span class="p">)</span>

<span class="c1">; returns a list containing the result of applying f to each member of xs</span>
<span class="p">(</span><span class="k">def </span><span class="nv">map</span>
  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span>
      <span class="p">(</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">map </span><span class="nv">f</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; calls a function with alternating pairs in a flat list (i.e. with pairs ungrouped)</span>
<span class="c1">;</span>
<span class="c1">; Takes 2-arity function and a flat pair sequence. Walks the sequence and calls</span>
<span class="c1">; f with 2 values at a time.</span>
<span class="c1">;</span>
<span class="c1">; Raises an error if the list has uneven length.</span>
<span class="c1">;</span>
<span class="c1">; =&gt; (map-pairs cons [:a 1 :b 2 :c 3])</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">map-pairs</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">ps</span><span class="p">]</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">map-pairs-acc</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">a</span> <span class="nv">ps</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">ps</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="p">[</span><span class="p">]</span>
        <span class="p">(</span><span class="nf">error</span> <span class="s">&#34;syntax: uneven pairs&#34;</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="nv">ps</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; binds values in a child scope</span>
<span class="c1">;</span>
<span class="c1">; Takes a flat pair sequence alternating bindings and their values. Binds</span>
<span class="c1">; and evaluates each value in sequence, allowing later bindings to refer to</span>
<span class="c1">; earlier bindings.</span>
<span class="c1">;</span>
<span class="c1">; Returns the result of evaluating the body in the child scope.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="k">let </span><span class="p">(</span><span class="nf">bindings</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">child</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>

  <span class="p">(</span><span class="nf">map-pairs</span>
    <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span>
      <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span>
    <span class="nv">bindings</span><span class="p">)</span>

  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; provide bindings to the current scope from a nested scope</span>
<span class="c1">;</span>
<span class="c1">; Allows for modularity in code, selectively providing bindings while</span>
<span class="c1">; encapsulating bindings that they use.</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nv">provide</span> <span class="p">[</span><span class="nv">symbols</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">inner</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">map</span>
      <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">sym</span><span class="p">]</span>
        <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">val </span><span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span>
              <span class="nv">com</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">commentary</span> <span class="nv">sym</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">comment </span><span class="p">[</span><span class="k">def </span><span class="nv">sym</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span> <span class="nv">com</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span>
          <span class="nv">sym</span><span class="p">)</span><span class="p">)</span>
      <span class="nv">symbols</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; binds symbols to values in the target scope</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nv">set!</span> <span class="p">[</span><span class="nv">target</span> <span class="nv">symbols</span> <span class="nv">values</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nv">symbols</span> <span class="p">[</span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">eval</span><span class="p">)</span> <span class="nv">values</span> <span class="nv">scope</span><span class="p">]</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">eval </span><span class="nv">target</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; binds symbols in the current scope to their values from the source</span>
<span class="c1">; scope</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nb">import </span><span class="p">[</span><span class="nv">source</span> <span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">set!</span> <span class="nv">scope</span> <span class="nv">symbols</span> <span class="p">[</span><span class="nb">list </span><span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span><span class="p">]</span>
        <span class="p">(</span><span class="nb">eval </span><span class="nv">source</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">[</span><span class="nv">cond</span><span class="p">]</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">cond-pairs</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">a</span> <span class="nv">ps</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">ps</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="nv">null</span>
        <span class="nv">uneven-pairs</span><span class="p">)</span> <span class="c1">; TODO: proper error</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">cond-pairs</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">do</span>
          <span class="p">(</span><span class="k">def </span><span class="p">(</span><span class="nf">ok</span> <span class="o">&amp;</span> <span class="nv">res</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
          <span class="p">(</span><span class="k">if </span><span class="nv">ok</span>
            <span class="nv">res</span>
            <span class="p">(</span><span class="nf">cond-pairs</span> <span class="nv">f</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; if-then-else with many clauses</span>
  <span class="c1">;</span>
  <span class="c1">; Takes a flat pair sequence alternating tests to evaluate and an</span>
  <span class="c1">; expression to evaluate if the test returns a truthy value.</span>
  <span class="c1">;</span>
  <span class="c1">; Returns the result of the evaluated branch, or null if no tests were true.</span>
  <span class="c1">;</span>
  <span class="c1">; By convention, :else is used as the final catch-all test, though any</span>
  <span class="c1">; truthy value works.</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nb">cond </span><span class="nv">clauses</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="nf">cond-pairs</span>
      <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">test </span><span class="nv">body</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eval </span><span class="nb">test </span><span class="nv">scope</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cons </span><span class="nv">true</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">body</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">cons </span><span class="nv">false</span> <span class="nv">null</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
      <span class="nv">null</span>
      <span class="nv">clauses</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; lazily evaluated boolean &#39;or&#39;</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nb">or </span><span class="nv">conds</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nf">cond</span>
    <span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span>
      <span class="nv">false</span>

    <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span>

    <span class="ss">:else</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span>
            <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="nv">xv</span>
          <span class="nv">xv</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">or </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; lazily evaluated boolean &#39;and&#39;</span>
<span class="p">(</span><span class="nf">defop</span> <span class="nb">and </span><span class="nv">conds</span> <span class="nv">scope</span>
  <span class="p">(</span><span class="nf">cond</span>
    <span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span>
      <span class="nv">true</span>

    <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span>

    <span class="ss">:else</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span>
            <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="nv">xv</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">and </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span>
          <span class="nv">xv</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; call an applicative&#39;s underlying operative with a list of arguments</span>
<span class="c1">;</span>
<span class="c1">; A scope may be provided as the third argument. If not specified, the</span>
<span class="c1">; operative will be called in a new empty scope.</span>
<span class="c1">;</span>
<span class="c1">; Used to call an applicative with pre-evaluated arguments, skipping the normal</span>
<span class="c1">; evaluation the applicative would perform prior to calling the underlying</span>
<span class="c1">; operative.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">apply </span><span class="p">[</span><span class="nv">appv</span> <span class="nv">arg</span> <span class="o">&amp;</span> <span class="nv">opt</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">appv</span><span class="p">)</span> <span class="nv">arg</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">opt</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">make-scope</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">first </span><span class="nv">opt</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">-&gt;</span><span class="p">)</span>
  <span class="c1">; threads a value through forms</span>
  <span class="c1">;</span>
  <span class="c1">; Calls the first form with the given value, passing the result to the second</span>
  <span class="c1">; form, and so on, returning the final value.</span>
  <span class="c1">;</span>
  <span class="c1">; A form may be a list or a single value. For a list, the value is inserted</span>
  <span class="c1">; before the second value, becoming the first argument. For a single value,</span>
  <span class="c1">; it is wrapped in a list with the value as the single argument.</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nb">-&gt; </span><span class="p">[</span><span class="nv">x</span> <span class="nv">f</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">v</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">pair?</span> <span class="nv">f</span><span class="p">)</span>
              <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">f</span><span class="o">&#39;</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">)</span> <span class="nv">f</span><span class="p">]</span>
                <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span><span class="o">&#39;</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span> <span class="nv">x</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">fs</span><span class="p">)</span>
        <span class="nv">v</span>
        <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">-&gt; </span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">case</span><span class="p">)</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">case-branches</span> <span class="p">[</span><span class="nv">scope</span> <span class="nb">val </span><span class="nv">branches</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">branches</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">errorf</span> <span class="s">&#34;no matching case branch: %s&#34;</span> <span class="nv">val</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">[</span><span class="nv">pattern</span> <span class="nv">expr</span> <span class="o">&amp;</span> <span class="nv">rest</span><span class="p">]</span> <span class="nv">branches</span>
            <span class="nv">child</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">bind</span> <span class="nv">child</span> <span class="nv">pattern</span> <span class="nv">val</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">eval </span><span class="nv">expr</span> <span class="nv">child</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">case-branches</span> <span class="nv">scope</span> <span class="nb">val </span><span class="nv">rest</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; evaluates the branch that successfully binds the given value</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nv">case</span> <span class="p">[</span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">bs</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="p">(</span><span class="nf">case-branches</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">v</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">bs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; identity function; returns its argument</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">id</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">93</span> <span class="mi">109</span> <span class="mi">196</span> <span class="mi">160</span> <span class="mi">158</span> <span class="mi">133</span> <span class="mi">79</span> <span class="mi">28</span> <span class="mi">134</span> <span class="mi">70</span> <span class="mi">184</span> <span class="mi">230</span> <span class="mi">180</span> <span class="mi">153</span> <span class="mi">247</span> <span class="mi">197</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">run.bass</span> <span class="c1">; returns a structure which will join the given values into a single string value</span>
<span class="c1">;</span>
<span class="c1">; Used to concatenate paths with string values to be passed as an argument to a</span>
<span class="c1">; workload.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">arg</span> <span class="nv">vals</span>
  <span class="p">{</span><span class="ss">:arg</span> <span class="nv">vals</span><span class="p">}</span><span class="p">)</span>

<span class="c1">; sets the :args field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-args</span> <span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:args</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :stdin field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-stdin</span> <span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">stdin</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:stdin</span> <span class="nv">stdin</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :entrypoint field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-entrypoint</span> <span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">entrypoint</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:entrypoint</span> <span class="nv">entrypoint</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :insecure field of the workload to true</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">insecure!</span> <span class="p">[</span><span class="nv">workload</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">with-insecure</span> <span class="nv">workload</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :insecure field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-insecure</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">val</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:insecure</span> <span class="nv">val</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="nf">provide</span> <span class="p">(</span><span class="nf">$</span><span class="p">)</span>
  <span class="p">(</span><span class="kd">defn </span><span class="nv">resolve-arg</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">scope</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">symbol? </span><span class="nv">a</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">word</span> <span class="p">(</span><span class="nf">symbol-&gt;string</span> <span class="nv">a</span><span class="p">)</span>
            <span class="nv">start</span> <span class="p">(</span><span class="nf">substring</span> <span class="nv">word</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span><span class="p">]</span>
        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">start</span> <span class="s">&#34;$&#34;</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="p">(</span><span class="nf">substring</span> <span class="nv">word</span> <span class="mi">1</span><span class="p">)</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span>
          <span class="nv">word</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval </span><span class="nv">a</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

  <span class="c1">; constructs a workload with args set as :args</span>
  <span class="c1">;</span>
  <span class="c1">; Symbol arguments are automatically converted to strings. Symbols beginning</span>
  <span class="c1">; with $ are resolved to their binding with the leading $ removed.</span>
  <span class="p">(</span><span class="nf">defop</span> <span class="nv">$</span> <span class="p">[</span><span class="nv">cmd</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span> <span class="nv">scope</span>
    <span class="c1">; TODO: check pair? args; could be splatted</span>
    <span class="c1">;</span>
    <span class="c1">; in fact, check if a trailing splat arg even works properly here?</span>
    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">as</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">resolve-arg</span> <span class="nv">a</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="nv">args</span><span class="p">)</span><span class="p">]</span>
      <span class="p">(</span><span class="nb">apply </span><span class="nv">with-args</span> <span class="p">[</span><span class="p">(</span><span class="p">(</span><span class="nb">eval </span><span class="nv">cmd</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="p">(</span><span class="k">def </span><span class="nv">linux</span>
  <span class="p">{</span><span class="ss">:os</span> <span class="s">&#34;linux&#34;</span><span class="p">}</span><span class="p">)</span>

<span class="p">(</span><span class="k">def </span><span class="nv">windows</span>
  <span class="p">{</span><span class="ss">:os</span> <span class="s">&#34;windows&#34;</span><span class="p">}</span><span class="p">)</span>

<span class="p">(</span><span class="k">def </span><span class="nv">darwin</span>
  <span class="p">{</span><span class="ss">:os</span> <span class="s">&#34;darwin&#34;</span><span class="p">}</span><span class="p">)</span>

<span class="c1">; the default platform for workloads that configure an image</span>
<span class="p">(</span><span class="k">def </span><span class="nv">*default-platform*</span>
  <span class="nv">linux</span><span class="p">)</span>

<span class="c1">; sets the :image field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">in-image</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">image</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span>
         <span class="ss">:image</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">string? </span><span class="nv">image</span><span class="p">)</span>
                  <span class="p">{</span><span class="ss">:repository</span> <span class="nv">image</span><span class="p">}</span>
                  <span class="nv">image</span><span class="p">)</span>
         <span class="ss">:platform</span> <span class="p">(</span><span class="ss">:platform</span> <span class="nv">workload</span> <span class="nv">*default-platform*</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :platform field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">on-platform</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">platform</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:platform</span> <span class="nv">platform</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :response field of the workload</span>
<span class="c1">;</span>
<span class="c1">; If source is :stdout, sets it to {:stdout true}.</span>
<span class="c1">; If source is :exit, sets it to {:exit-code true}.</span>
<span class="c1">; If source is a path?, sets it to {:file source}.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">response-from</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span>
         <span class="ss">:response</span>
         <span class="p">(</span><span class="nf">cond</span>
           <span class="p">(</span><span class="nb">= </span><span class="ss">:stdin</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:stdout</span> <span class="nv">true</span><span class="p">}</span>
           <span class="p">(</span><span class="nb">= </span><span class="ss">:exit</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:exit-code</span> <span class="nv">true</span><span class="p">}</span>
           <span class="p">(</span><span class="nf">path?</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:file</span> <span class="nv">source</span><span class="p">}</span>
           <span class="ss">:else</span> <span class="nv">unknown-response</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :dir field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">in-dir</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">dir</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:dir</span> <span class="nv">dir</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; appends a mount to the :mounts field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-mount</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span> <span class="nv">target</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">cur</span> <span class="p">(</span><span class="ss">:mounts</span> <span class="nv">workload</span> <span class="p">[</span><span class="p">]</span><span class="p">)</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span>
           <span class="ss">:mounts</span>
           <span class="p">(</span><span class="nb">conj </span><span class="nv">cur</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:target</span> <span class="nv">target</span><span class="p">}</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :mounts field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-mounts</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">mounts</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:mounts</span> <span class="nv">mounts</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; inserts an env var and value into the :env field of the workload</span>
<span class="c1">;</span>
<span class="c1">; TODO: append, add in stable order</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-env-var</span> <span class="p">[</span><span class="nv">workload</span> <span class="nb">name </span><span class="nv">value</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:env</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">name </span><span class="nv">value</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; sets the :env field of the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">with-env</span> <span class="p">[</span><span class="nv">workload</span> <span class="nv">env</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="nv">env</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; attaches metadata to the workload</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">with-meta </span><span class="p">[</span><span class="nv">workload</span> <span class="nb">key </span><span class="nv">val</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:meta</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:meta</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">key </span><span class="nv">val</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">64</span> <span class="mi">106</span> <span class="mi">99</span> <span class="mi">121</span> <span class="mi">180</span> <span class="mi">114</span> <span class="mi">34</span> <span class="mi">166</span> <span class="mi">165</span> <span class="mi">102</span> <span class="mi">139</span> <span class="mi">99</span> <span class="mi">230</span> <span class="mi">100</span> <span class="mi">1</span> <span class="mi">52</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">streams.bass</span> <span class="c1">; returns the last value from the stream</span>
<span class="c1">;</span>
<span class="c1">; As with (next), a default may be provided to be returned when the stream is</span>
<span class="c1">; empty. If not provided, an error will be raised if the stream is empty.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">last </span><span class="p">[</span><span class="nv">stream</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">default</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span><span class="p">)</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">do</span>
      <span class="p">(</span><span class="k">def </span><span class="nv">v</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">v</span> <span class="ss">:end</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">first </span><span class="nv">default</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="nv">v</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>

<span class="c1">; calls f for every value read from the stream</span>
<span class="c1">;</span>
<span class="c1">; Returns null.</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">each</span> <span class="p">[</span><span class="nv">stream</span> <span class="nv">f</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">n</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="ss">:end</span><span class="p">)</span>
      <span class="nv">null</span>
      <span class="p">(</span><span class="nf">do</span>
        <span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">each</span> <span class="nv">stream</span> <span class="nv">f</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">17</span> <span class="mi">21</span> <span class="mi">240</span> <span class="mi">146</span> <span class="mi">22</span> <span class="mi">151</span> <span class="mi">124</span> <span class="mi">1</span> <span class="mi">215</span> <span class="mi">206</span> <span class="mi">171</span> <span class="mi">189</span> <span class="mi">103</span> <span class="mi">107</span> <span class="mi">128</span> <span class="mi">78</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">strings.bass</span> <span class="c1">; joins a list of strings together with delim in between</span>
<span class="p">(</span><span class="kd">defn </span><span class="nb">join </span><span class="p">[</span><span class="nv">delim</span> <span class="nv">strs</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">case</span> <span class="nv">strs</span>
    <span class="p">[</span><span class="p">]</span> <span class="s">&#34;&#34;</span>
    <span class="p">[</span><span class="nv">s</span><span class="p">]</span> <span class="nv">s</span>
    <span class="p">[</span><span class="nv">s</span> <span class="o">&amp;</span> <span class="nv">ss</span><span class="p">]</span> <span class="p">(</span><span class="nb">str </span><span class="nv">s</span> <span class="nv">delim</span> <span class="p">(</span><span class="nb">join </span><span class="nv">delim</span> <span class="nv">ss</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">110</span> <span class="mi">93</span> <span class="mi">14</span> <span class="mi">96</span> <span class="mi">5</span> <span class="mi">77</span> <span class="mi">37</span> <span class="mi">44</span> <span class="mi">139</span> <span class="mi">78</span> <span class="mi">174</span> <span class="mi">177</span> <span class="mi">106</span> <span class="mi">61</span> <span class="mi">232</span> <span class="mi">101</span><span class="p">]</span><span class="p">}</span> <span class="p">{</span><span class="nv">yaml.bass</span> <span class="c1">; decodes the YAML content of the given file</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">decode</span> <span class="p">[</span><span class="nv">path</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">yaml-decode</span> <span class="nv">path</span><span class="p">)</span><span class="p">)</span>
 <span class="p">[</span><span class="mi">210</span> <span class="mi">211</span> <span class="mi">230</span> <span class="mi">233</span> <span class="mi">94</span> <span class="mi">154</span> <span class="mi">240</span> <span class="mi">243</span> <span class="mi">234</span> <span class="mi">249</span> <span class="mi">53</span> <span class="mi">185</span> <span class="mi">81</span> <span class="mi">143</span> <span class="mi">135</span> <span class="mi">92</span><span class="p">]</span><span class="p">}</span><span class="p">]</span><span class="p">)</span><span class="p">}</span><span class="nv">/</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*stdin*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;source</span><span class="err">:</span> <span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">*stdout*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;sink</span><span class="err">:</span> <span class="nv">&lt;workload</span><span class="err">:</span> <span class="nv">e5127b2fb0a6aa915b32dd6807dd3fa285ae7168&gt;&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">+</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">+ </span><span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">-</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">- </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">-&gt;</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">f</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">v</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">pair?</span> <span class="nv">f</span><span class="p">)</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">f</span><span class="o">&#39;</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">)</span> <span class="nv">f</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span><span class="o">&#39;</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">as</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">f</span> <span class="nv">x</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">fs</span><span class="p">)</span> <span class="nv">v</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">-&gt; </span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">fs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;=</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&lt;= </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">=</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">= </span><span class="nb">val </span><span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&gt;</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&gt; </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&gt;=</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">&gt;= </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">and</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">conds</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span> <span class="nv">true</span> <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span> <span class="ss">:else</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span> <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">and </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">xv</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">append</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nv">xss</span> <span class="p">(</span><span class="nf">foldl</span> <span class="nv">append1</span> <span class="p">(</span><span class="p">)</span> <span class="nv">xss</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">applicative?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">applicative?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">apply</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">appv</span> <span class="nv">arg</span> <span class="o">&amp;</span> <span class="nv">opt</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">appv</span><span class="p">)</span> <span class="nv">arg</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">opt</span><span class="p">)</span> <span class="p">(</span><span class="nf">make-scope</span><span class="p">)</span> <span class="p">(</span><span class="nb">first </span><span class="nv">opt</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">arg</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nb">vals </span><span class="p">{</span><span class="ss">:arg</span> <span class="nv">vals</span><span class="p">}</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">assoc</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">obj</span> <span class="o">&amp;</span> <span class="nv">kvs</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">bind</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">bind</span> <span class="nv">scope</span> <span class="nv">formals</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">boolean?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">boolean?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">case</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">v</span> <span class="o">&amp;</span> <span class="nv">bs</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">case-branches</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">v</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">bs</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">combiner?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">combiner?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">comment</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">comment </span><span class="nv">form</span> <span class="nv">annotated</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">commentary</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">commentary</span> <span class="nv">sym</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">cond</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">clauses</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">cond-pairs</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">test </span><span class="nv">body</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eval </span><span class="nb">test </span><span class="nv">scope</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">true</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">body</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">false</span> <span class="nv">null</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="nv">null</span> <span class="nv">clauses</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">conj</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">xs</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span> <span class="p">[</span><span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">]</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span> <span class="p">(</span><span class="nb">conj </span><span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span> <span class="nv">y</span> <span class="o">&amp;</span> <span class="nv">ys</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">cons</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">a</span> <span class="nv">d</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">darwin</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;darwin&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">def</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">def </span><span class="nb">binding </span><span class="nv">value</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">defn</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="k">fn </span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">defop</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nb">name </span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">name </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">do</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">doc</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">doc </span><span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">dump</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">dump</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">each</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">stream</span> <span class="nv">f</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">n</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="ss">:end</span><span class="p">)</span> <span class="nv">null</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">each</span> <span class="nv">stream</span> <span class="nv">f</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">emit</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">emit</span> <span class="nb">val </span><span class="nv">sink</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">empty?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">empty?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">error</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">error</span> <span class="nv">msg</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">errorf</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">errorf</span> <span class="nv">fmt</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">eval</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">form</span> <span class="nv">scope</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">filter</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">append</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">first</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">f</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">f</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">fn</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">formals</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">_</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">foldl</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span> <span class="p">(</span><span class="p">)</span> <span class="nv">z</span> <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">foldl</span> <span class="nv">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">z</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">foldr</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">xs</span> <span class="p">(</span><span class="p">)</span> <span class="nv">z</span> <span class="p">[</span><span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">]</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span> <span class="p">(</span><span class="nf">foldr</span> <span class="nv">f</span> <span class="nv">z</span> <span class="nv">xs</span><span class="o">&#39;</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">get-current-scope</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">_</span> <span class="nv">scope</span> <span class="nv">scope</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">get-image-resource</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">resource</span> <span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">got</span> <span class="p">(</span><span class="p">(</span><span class="ss">:get</span> <span class="nv">resource</span><span class="p">)</span> <span class="nv">version</span> <span class="ss">:format</span> <span class="s">&#34;oci&#34;</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">]</span> <span class="nv">got/image.tar</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">get-latest</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">r</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span> <span class="p">(</span><span class="p">(</span><span class="ss">:get</span> <span class="nv">r</span><span class="p">)</span> <span class="p">(</span><span class="nb">last </span><span class="p">(</span><span class="p">(</span><span class="ss">:check</span> <span class="nv">r</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">get-latest-image-resource</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">resource</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">check</span> <span class="p">(</span><span class="p">(</span><span class="ss">:check-every</span> <span class="nv">resource</span><span class="p">)</span> <span class="p">(</span><span class="ss">:image-check-interval</span> <span class="nv">*config*</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nf">get-image-resource</span> <span class="nv">resource</span> <span class="p">(</span><span class="nb">last </span><span class="nv">check</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">ground</span></code></div>
        
        <div class="object-cell">ground</div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">id</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">if</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">if </span><span class="nb">cond </span><span class="nv">yes</span> <span class="nv">no</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">ignore?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">ignore?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">import</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">source</span> <span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">set!</span> <span class="nv">scope</span> <span class="nv">symbols</span> <span class="p">[</span><span class="nb">list </span><span class="o">&amp;</span> <span class="nv">symbols</span><span class="p">]</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">source</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">in-dir</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">dir</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:dir</span> <span class="nv">dir</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">in-image</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">image</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:image</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">string? </span><span class="nv">image</span><span class="p">)</span> <span class="p">{</span><span class="ss">:repository</span> <span class="nv">image</span><span class="p">}</span> <span class="nv">image</span><span class="p">)</span> <span class="ss">:platform</span> <span class="p">(</span><span class="ss">:platform</span> <span class="nv">workload</span> <span class="nv">*default-platform*</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">insecure!</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span><span class="p">]</span> <span class="p">(</span><span class="nf">with-insecure</span> <span class="nv">workload</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">last</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">stream</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">default</span><span class="p">)</span> <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="k">def </span><span class="nv">v</span> <span class="p">(</span><span class="nb">next </span><span class="nv">stream</span> <span class="ss">:end</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">v</span> <span class="ss">:end</span><span class="p">)</span> <span class="p">(</span><span class="nb">first </span><span class="nv">default</span><span class="p">)</span> <span class="p">(</span><span class="nb">last </span><span class="nv">stream</span> <span class="nv">v</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">length</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span> <span class="mi">0</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">let</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="nf">bindings</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span> <span class="nv">scope</span> <span class="p">(</span><span class="nf">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span><span class="nb">&gt; </span><span class="p">(</span><span class="k">def </span><span class="nv">child</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nb">binding </span><span class="nv">val</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span> <span class="nv">bindings</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">child</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">linux</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;linux&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nv">values</span> <span class="nv">values</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list*</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="nv">args</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="k">def </span><span class="nv">aux</span> <span class="p">(</span><span class="nf">wrap</span> <span class="p">(</span><span class="nf">op</span> <span class="p">(</span><span class="p">(</span><span class="nf">head</span> <span class="o">&amp;</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span> <span class="nv">_</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">tail</span><span class="p">)</span> <span class="nv">head</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">head</span> <span class="p">(</span><span class="nf">aux</span> <span class="nv">tail</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">aux</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list-&gt;scope</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">kwargs</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">{</span><span class="p">}</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">list?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">list?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">load</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">load </span><span class="nv">workload</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">log</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">log</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">logf</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">logf</span> <span class="nv">fmt</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">make-scope</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="o">&amp;</span> <span class="nv">parents</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">map</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">xs</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">xs</span><span class="p">)</span> <span class="p">(</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">map </span><span class="nv">f</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">xs</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">map-pairs</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">f</span> <span class="nv">ps</span><span class="p">]</span> <span class="p">(</span><span class="nf">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span><span class="nb">&gt; </span><span class="p">(</span><span class="kd">defn </span><span class="nv">map-pairs-acc</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">a</span> <span class="nv">ps</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="p">)</span> <span class="p">(</span><span class="nf">error</span> <span class="s">&#34;syntax: uneven pairs&#34;</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">null?</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">f</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">first </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="p">(</span><span class="nb">rest </span><span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">map-pairs-acc</span> <span class="nv">f</span> <span class="nv">null</span> <span class="nv">ps</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">max</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">max </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">merge</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">obj</span> <span class="o">&amp;</span> <span class="nv">objs</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">min</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">min </span><span class="nv">num</span> <span class="o">&amp;</span> <span class="nv">nums</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">next</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">next </span><span class="nv">src</span> <span class="o">&amp;</span> <span class="nv">default</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">not</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="nv">x</span> <span class="nv">false</span> <span class="nv">true</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">now</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">now</span> <span class="nv">duration</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">null?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">null?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">number?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">number?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">on-platform</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">platform</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:platform</span> <span class="nv">platform</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">op</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">formals</span> <span class="nv">eformal</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">op</span> <span class="nv">formals</span> <span class="nv">eformal</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">length</span> <span class="nv">body</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="k">do </span><span class="nv">body</span><span class="p">)</span> <span class="p">(</span><span class="nb">first </span><span class="nv">body</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">operative?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">operative?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">or</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="nv">conds</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nf">empty?</span> <span class="nv">conds</span><span class="p">)</span> <span class="nv">false</span> <span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">conds</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">first </span><span class="nv">conds</span><span class="p">)</span> <span class="nv">scope</span><span class="p">)</span> <span class="ss">:else</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="p">(</span><span class="nf">x</span> <span class="o">&amp;</span> <span class="nv">xs</span><span class="p">)</span> <span class="nv">conds</span> <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="nv">xv</span> <span class="nv">xv</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">or </span><span class="o">&amp;</span> <span class="nv">xs</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">pair?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">pair?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">path</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">path </span><span class="nv">workload</span> <span class="nv">path</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">path?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">path?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">provide</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">symbols</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">inner</span> <span class="p">(</span><span class="nf">make-scope</span> <span class="nv">scope</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">sym</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">val </span><span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span> <span class="nv">com</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nv">commentary</span> <span class="nv">sym</span><span class="p">]</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="nb">comment </span><span class="p">[</span><span class="k">def </span><span class="nv">sym</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">sym</span> <span class="nv">inner</span><span class="p">)</span><span class="p">]</span> <span class="nv">com</span><span class="p">]</span> <span class="nv">scope</span><span class="p">)</span> <span class="nv">sym</span><span class="p">)</span><span class="p">)</span> <span class="nv">symbols</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">quote</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">form</span><span class="p">]</span> <span class="nv">_</span> <span class="nv">form</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">reduce-kv</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">reduce-kv</span> <span class="nv">f</span> <span class="nv">init</span> <span class="nv">kv</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">resource</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">type</span> <span class="nv">source</span><span class="p">]</span> <span class="p">(</span><span class="nf">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="k">do </span><span class="o">&amp;</span> <span class="nv">body</span><span class="p">)</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">provide</span> <span class="p">[</span><span class="nv">check</span> <span class="nv">check-every</span> <span class="nb">get </span><span class="nv">put</span><span class="p">]</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">check</span> <span class="nv">optional-version</span> <span class="p">(</span><span class="nf">check-every</span> <span class="p">(</span><span class="ss">:check-interval</span> <span class="nv">*config*</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">optional-version</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">check-every</span> <span class="p">[</span><span class="nv">interval</span> <span class="o">&amp;</span> <span class="nv">optional-version</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">version</span> <span class="p">(</span><span class="nf">case</span> <span class="nv">optional-version</span> <span class="p">(</span><span class="p">)</span> <span class="nv">null</span> <span class="p">(</span><span class="nf">v</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span> <span class="nv">v</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">stream</span> <span class="p">(</span><span class="nb">next </span><span class="p">(</span><span class="nf">run</span> <span class="p">(</span><span class="nf">check-wl</span> <span class="nv">version</span> <span class="nv">interval</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="kd">defn </span><span class="nb">get </span><span class="p">[</span><span class="nv">version</span> <span class="o">&amp;</span> <span class="nv">params</span><span class="p">]</span> <span class="p">(</span><span class="nb">path </span><span class="p">(</span><span class="nf">get-wl</span> <span class="nv">version</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">params</span><span class="p">)</span><span class="p">)</span> <span class="nv">./</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">put</span> <span class="nv">params</span> <span class="p">(</span><span class="nb">next </span><span class="p">(</span><span class="nf">run</span> <span class="p">(</span><span class="nf">put-wl</span> <span class="nv">version</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">params</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="k">def </span><span class="nv">image</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">symbol? </span><span class="nv">type</span><span class="p">)</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="nv">*config*</span> <span class="ss">:types</span> <span class="nv">type</span><span class="p">)</span> <span class="nv">type</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">check-wl</span> <span class="p">[</span><span class="nv">version</span> <span class="nv">interval</span><span class="p">]</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/check</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:version</span> <span class="nv">version</span><span class="p">}</span><span class="p">)</span> <span class="p">(</span><span class="nb">with-meta </span><span class="ss">:at</span> <span class="p">(</span><span class="nf">now</span> <span class="nv">interval</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">get-wl</span> <span class="p">[</span><span class="nv">version</span> <span class="nv">params</span><span class="p">]</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/in</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:version</span> <span class="nv">version</span> <span class="ss">:params</span> <span class="nv">params</span><span class="p">}</span><span class="p">)</span> <span class="p">(</span><span class="nf">with-args</span> <span class="nv">./</span><span class="p">)</span> <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">put-wl</span> <span class="p">[</span><span class="nv">params</span><span class="p">]</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">/opt/resource/out</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:params</span> <span class="nv">params</span><span class="p">}</span><span class="p">)</span> <span class="p">(</span><span class="nf">with-args</span> <span class="nv">./</span><span class="p">)</span> <span class="p">(</span><span class="nf">in-image</span> <span class="nv">image</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span> <span class="p">(</span><span class="nf">get-current-scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">response-from</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:response</span> <span class="p">(</span><span class="nb">cond </span><span class="p">(</span><span class="nb">= </span><span class="ss">:stdin</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:stdout</span> <span class="nv">true</span><span class="p">}</span> <span class="p">(</span><span class="nb">= </span><span class="ss">:exit</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:exit-code</span> <span class="nv">true</span><span class="p">}</span> <span class="p">(</span><span class="nf">path?</span> <span class="nv">source</span><span class="p">)</span> <span class="p">{</span><span class="ss">:file</span> <span class="nv">source</span><span class="p">}</span> <span class="ss">:else</span> <span class="nv">unknown-response</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">rest</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="o">&amp;</span> <span class="nv">r</span><span class="p">)</span><span class="p">]</span> <span class="nv">r</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">run</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">run</span> <span class="nv">workload</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">run-task</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">config-path</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">config</span> <span class="p">(</span><span class="p">(</span><span class="ss">:decode</span> <span class="nv">yaml</span><span class="p">)</span> <span class="nv">config-path</span><span class="p">)</span> <span class="nv">opts</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="nv">kwargs</span><span class="p">)</span> <span class="nv">workload</span> <span class="p">(</span><span class="nf">task-&gt;workload</span> <span class="nv">config</span> <span class="nv">opts</span><span class="p">)</span> <span class="nv">output-configs</span> <span class="p">(</span><span class="ss">:outputs</span> <span class="nv">config</span> <span class="p">(</span><span class="p">)</span><span class="p">)</span> <span class="nv">output-pairs</span> <span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">output</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">name </span><span class="p">(</span><span class="ss">:name</span> <span class="nv">output</span><span class="p">)</span> <span class="nv">src</span> <span class="p">(</span><span class="ss">:path</span> <span class="nv">output</span> <span class="nv">name</span><span class="p">)</span><span class="p">]</span> <span class="p">[</span><span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">name</span><span class="p">)</span> <span class="p">(</span><span class="nb">path </span><span class="nv">workload</span> <span class="p">(</span><span class="nf">string-&gt;dir</span> <span class="nv">src</span><span class="p">)</span><span class="p">)</span><span class="p">]</span><span class="p">)</span><span class="p">)</span> <span class="nv">output-configs</span><span class="p">)</span> <span class="nv">outputs</span> <span class="p">(</span><span class="nf">list-&gt;scope</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">append</span> <span class="nv">output-pairs</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="p">{</span><span class="ss">:outputs</span> <span class="nv">outputs</span> <span class="ss">:result</span> <span class="p">(</span><span class="nf">run</span> <span class="nv">workload</span><span class="p">)</span><span class="p">}</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">scope-&gt;list</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">scope-&gt;list</span> <span class="nv">obj</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">scope?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">scope?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">second</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">set!</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">op</span> <span class="p">[</span><span class="nv">target</span> <span class="nv">symbols</span> <span class="nv">values</span><span class="p">]</span> <span class="nv">scope</span> <span class="p">(</span><span class="nb">eval </span><span class="p">[</span><span class="k">def </span><span class="nv">symbols</span> <span class="p">[</span><span class="p">(</span><span class="nf">unwrap</span> <span class="nv">eval</span><span class="p">)</span> <span class="nv">values</span> <span class="nv">scope</span><span class="p">]</span><span class="p">]</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">target</span> <span class="nv">scope</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">sink?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">sink?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">source?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">source?</span> <span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">str</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">str </span><span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">stream</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">stream</span> <span class="o">&amp;</span> <span class="nv">vals</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;dir</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;dir</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;path</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;path</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;run-path</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;run-path</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string-&gt;symbol</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">string-&gt;symbol</span> <span class="nv">str</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">string?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">string? </span><span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">substring</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">substring</span> <span class="nb">str </span><span class="nv">start</span> <span class="o">&amp;</span> <span class="nv">end</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">symbol-&gt;string</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">symbol-&gt;string</span> <span class="nv">sym</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">symbol?</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">symbol? </span><span class="nv">val</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">third</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="p">(</span><span class="nf">_</span> <span class="nv">_</span> <span class="nv">x</span> <span class="o">&amp;</span> <span class="nv">_</span><span class="p">)</span><span class="p">]</span> <span class="nv">x</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">time</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nb">time </span><span class="nv">form</span><span class="p">)</span><span class="nv">&gt;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">unwrap</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">unwrap</span> <span class="nv">app</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">windows</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;windows&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-args</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">args</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:args</span> <span class="nv">args</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-entrypoint</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">entrypoint</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:entrypoint</span> <span class="nv">entrypoint</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-env</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">env</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="nv">env</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-env-var</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nb">name </span><span class="nv">value</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:env</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:env</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">name </span><span class="nv">value</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-insecure</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">val</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:insecure</span> <span class="nv">val</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-meta</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nb">key </span><span class="nv">val</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:meta</span> <span class="p">(</span><span class="nb">assoc </span><span class="p">(</span><span class="ss">:meta</span> <span class="nv">workload</span> <span class="p">{</span><span class="p">}</span><span class="p">)</span> <span class="nb">key </span><span class="nv">val</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-mount</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">source</span> <span class="nv">target</span><span class="p">]</span> <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">cur</span> <span class="p">(</span><span class="ss">:mounts</span> <span class="nv">workload</span> <span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:mounts</span> <span class="p">(</span><span class="nb">conj </span><span class="nv">cur</span> <span class="p">{</span><span class="ss">:source</span> <span class="nv">source</span> <span class="ss">:target</span> <span class="nv">target</span><span class="p">}</span><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-mounts</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="nv">mounts</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:mounts</span> <span class="nv">mounts</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">with-stdin</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">workload</span> <span class="o">&amp;</span> <span class="nv">stdin</span><span class="p">]</span> <span class="p">(</span><span class="nb">assoc </span><span class="nv">workload</span> <span class="ss">:stdin</span> <span class="nv">stdin</span><span class="p">)</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">wrap</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">wrap</span> <span class="nv">comb</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">yaml-decode</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="p">(</span><span class="nf">wrap</span> <span class="nv">&lt;builtin</span> <span class="nv">op</span><span class="err">:</span> <span class="p">(</span><span class="nf">yaml-decode</span> <span class="nv">workload-path</span><span class="p">)</span><span class="nv">&gt;</span><span class="p">)</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div>
    </div>
  </div>

</div><div class="bass-commentary">
  <div class="bass-binding"><a id="*default-config*"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/concourse.bass#L23-L27">
    <code class="chroma signature"><code class="highlight chroma"><span class="nv">*default-config*</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">scope?</span> <span class="fg-yellow">scope?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>the default configuration, if none is supplied on *stdin*</p></div>
  </div>
  
  <div class="binding-value">
    <div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">check-interval</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">3600</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">image-check-interval</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="mi">86400</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">platforms</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">linux</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">os</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;linux&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">types</span></code></div>
        
        <div class="object-cell"><div class="delimited multiline">
  <div class="open"><code class="chroma p">{</code></div>
  <div class="content">
    <div class="object">
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">docker-image</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/docker-image-resource&#34;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">git</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/git-resource&#34;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">registry-image</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/registry-image-resource&#34;</span></code></div>
        
      </div>
      
      <div class="object-field">
        
        <div class="object-cell"><code class="highlight chroma"><span class="nv">time</span></code></div>
        
        <div class="object-cell"><code class="highlight chroma"><span class="s">&#34;concourse/time-resource&#34;</span></code></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div></div>
        
      </div>
      
    </div>
  </div>
  <div class="close"><code class="chroma p">}</code></div>
</div>
  </div>
  
</div><div class="bass-binding"><a id="resource"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/concourse.bass#L38">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">resource</span> <span class="nv">type</span> <span class="nv">source</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>constructs a resource scope</p><p>If type is a keyword, it is mapped to an image via :types in the module configuration.</p><p>Otherwise, it is passed along to `in-image`.</p></div>
  </div>
  
</div><div class="bass-binding"><a id="get-latest"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/concourse.bass#L84-L85">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">get-latest</span> <span class="nv">r</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>gets the latest version of a resource</p></div>
  </div>
  
</div><div class="bass-binding"><a id="run-task"></a><a class="comment-title ansi-line" href="https://github.com/vito/bass/tree/main/std/concourse.bass#L96">
    <code class="chroma signature"><code class="highlight chroma"><span class="p">(</span><span class="nf">run-task</span> <span class="nv">config-path</span> <span class="o">&amp;</span> <span class="nv">kwargs</span><span class="p">)</span></code></code>
    <code class="chroma predicates"> <span class="fg-yellow">applicative?</span> <span class="fg-yellow">combiner?</span></code>
  </a>
  <div class="comment-body">
    <div class="literate"><p>run a task with the given parameters</p><p>The :inputs param provides as a mapping from name to workload path.</p><p>Returns an scope with :outputs bound to a mapping from name to workload path, and :result bound to the workload&#39;s stream.</p></div>
  </div>
  
</div>
</div>


  

  

    </div>

    <div class="sidebar">
      <nav>
        <a href="index.html" class="section-link top">bass</a>

        <ul>
        
        <li><a href="demos.html" class="section-link">demos</a></li>
        
        <li><a href="guide.html" class="section-link">guide</a></li>
        
        <li><a href="bassics.html" class="section-link">bassics</a></li>
        
        <li><a href="stdlib.html" class="section-link current">stdlib</a></li>
        
        <li><a href="meta.html" class="section-link">meta</a></li>
        
        </ul>
      </nav>

      <div class="choose-theme" id="choosetheme">
        <select id="styleswitcher" onchange="switchStyle(event)">
          <option value=""></option>
          <option value="3024">3024</option>
<option value="apathy">apathy</option>
<option value="apprentice">apprentice</option>
<option value="ashes">ashes</option>
<option value="atelier-cave">atelier-cave</option>
<option value="atelier-dune">atelier-dune</option>
<option value="atelier-estuary">atelier-estuary</option>
<option value="atelier-forest">atelier-forest</option>
<option value="atelier-heath">atelier-heath</option>
<option value="atelier-lakeside">atelier-lakeside</option>
<option value="atelier-plateau">atelier-plateau</option>
<option value="atelier-savanna">atelier-savanna</option>
<option value="atelier-seaside">atelier-seaside</option>
<option value="atelier-sulphurpool">atelier-sulphurpool</option>
<option value="atlas">atlas</option>
<option value="bespin">bespin</option>
<option value="black-metal-bathory">black-metal-bathory</option>
<option value="black-metal-burzum">black-metal-burzum</option>
<option value="black-metal-gorgoroth">black-metal-gorgoroth</option>
<option value="black-metal-immortal">black-metal-immortal</option>
<option value="black-metal-khold">black-metal-khold</option>
<option value="black-metal-marduk">black-metal-marduk</option>
<option value="black-metal-mayhem">black-metal-mayhem</option>
<option value="black-metal-nile">black-metal-nile</option>
<option value="black-metal-venom">black-metal-venom</option>
<option value="black-metal">black-metal</option>
<option value="brewer">brewer</option>
<option value="bright">bright</option>
<option value="brogrammer">brogrammer</option>
<option value="brushtrees">brushtrees</option>
<option value="chalk">chalk</option>
<option value="circus">circus</option>
<option value="codeschool">codeschool</option>
<option value="cupcake">cupcake</option>
<option value="cupertino">cupertino</option>
<option value="danqing">danqing</option>
<option value="darcula">darcula</option>
<option value="decaf">decaf</option>
<option value="dirtysea">dirtysea</option>
<option value="dracula">dracula</option>
<option value="eighties">eighties</option>
<option value="embers">embers</option>
<option value="espresso">espresso</option>
<option value="eva-dim">eva-dim</option>
<option value="eva">eva</option>
<option value="flat">flat</option>
<option value="framer">framer</option>
<option value="fruit-soda">fruit-soda</option>
<option value="gigavolt">gigavolt</option>
<option value="github">github</option>
<option value="green-screen">green-screen</option>
<option value="greenscreen">greenscreen</option>
<option value="hardcore">hardcore</option>
<option value="heetch">heetch</option>
<option value="helios">helios</option>
<option value="hopscotch">hopscotch</option>
<option value="icy">icy</option>
<option value="ir-black">ir-black</option>
<option value="irblack">irblack</option>
<option value="isotope">isotope</option>
<option value="kimber">kimber</option>
<option value="london-tube">london-tube</option>
<option value="macintosh">macintosh</option>
<option value="marrakesh">marrakesh</option>
<option value="materia">materia</option>
<option value="material-palenight">material-palenight</option>
<option value="material-vivid">material-vivid</option>
<option value="material">material</option>
<option value="mellow-purple">mellow-purple</option>
<option value="mocha">mocha</option>
<option value="monokai">monokai</option>
<option value="nebula">nebula</option>
<option value="nord">nord</option>
<option value="nova">nova</option>
<option value="ocean">ocean</option>
<option value="oceanicnext">oceanicnext</option>
<option value="paraiso">paraiso</option>
<option value="pasque">pasque</option>
<option value="phd">phd</option>
<option value="pico">pico</option>
<option value="pinky">pinky</option>
<option value="pop">pop</option>
<option value="porple">porple</option>
<option value="qualia">qualia</option>
<option value="railscasts">railscasts</option>
<option value="rebecca">rebecca</option>
<option value="rose-pine-dawn">rose-pine-dawn</option>
<option value="rose-pine-moon">rose-pine-moon</option>
<option value="rose-pine">rose-pine</option>
<option value="sakura">sakura</option>
<option value="sandcastle">sandcastle</option>
<option value="seti-ui">seti-ui</option>
<option value="seti">seti</option>
<option value="shades-of-purple">shades-of-purple</option>
<option value="shapeshifter">shapeshifter</option>
<option value="snazzy">snazzy</option>
<option value="solar-flare">solar-flare</option>
<option value="solarflare">solarflare</option>
<option value="spacemacs">spacemacs</option>
<option value="summercamp">summercamp</option>
<option value="tango">tango</option>
<option value="tender">tender</option>
<option value="tomorrow-night-eighties">tomorrow-night-eighties</option>
<option value="tomorrow-night">tomorrow-night</option>
<option value="tomorrow">tomorrow</option>
<option value="tube">tube</option>
<option value="vulcan">vulcan</option>
<option value="windows-10">windows-10</option>
<option value="windows-95">windows-95</option>
<option value="windows-highcontrast">windows-highcontrast</option>
<option value="windows-nt">windows-nt</option>
<option value="woodland">woodland</option>
<option value="xcode-dusk">xcode-dusk</option>
<option value="zenburn">zenburn</option>
<option value="atelier-cave-light">atelier-cave-light</option>
<option value="atelier-dune-light">atelier-dune-light</option>
<option value="atelier-estuary-light">atelier-estuary-light</option>
<option value="atelier-forest-light">atelier-forest-light</option>
<option value="atelier-heath-light">atelier-heath-light</option>
<option value="atelier-lakeside-light">atelier-lakeside-light</option>
<option value="atelier-plateau-light">atelier-plateau-light</option>
<option value="atelier-savanna-light">atelier-savanna-light</option>
<option value="atelier-seaside-light">atelier-seaside-light</option>
<option value="atelier-sulphurpool-light">atelier-sulphurpool-light</option>
<option value="classic-light">classic-light</option>
<option value="default-light">default-light</option>
<option value="edge-light">edge-light</option>
<option value="equilibrium-gray-light">equilibrium-gray-light</option>
<option value="equilibrium-light">equilibrium-light</option>
<option value="google-light">google-light</option>
<option value="grayscale-light">grayscale-light</option>
<option value="harmonic-light">harmonic-light</option>
<option value="harmonic16-light">harmonic16-light</option>
<option value="heetch-light">heetch-light</option>
<option value="horizon-light">horizon-light</option>
<option value="horizon-terminal-light">horizon-terminal-light</option>
<option value="humanoid-light">humanoid-light</option>
<option value="ia-light">ia-light</option>
<option value="mexico-light">mexico-light</option>
<option value="one-light">one-light</option>
<option value="papercolor-light">papercolor-light</option>
<option value="silk-light">silk-light</option>
<option value="solarflare-light">solarflare-light</option>
<option value="solarized-light">solarized-light</option>
<option value="summerfruit-light">summerfruit-light</option>
<option value="synth-midnight-light">synth-midnight-light</option>
<option value="unikitty-light">unikitty-light</option>
<option value="windows-10-light">windows-10-light</option>
<option value="windows-95-light">windows-95-light</option>
<option value="windows-highcontrast-light">windows-highcontrast-light</option>
<option value="windows-nt-light">windows-nt-light</option>
<option value="brushtrees-dark">brushtrees-dark</option>
<option value="classic-dark">classic-dark</option>
<option value="default-dark">default-dark</option>
<option value="edge-dark">edge-dark</option>
<option value="equilibrium-dark">equilibrium-dark</option>
<option value="equilibrium-gray-dark">equilibrium-gray-dark</option>
<option value="google-dark">google-dark</option>
<option value="grayscale-dark">grayscale-dark</option>
<option value="harmonic-dark">harmonic-dark</option>
<option value="harmonic16-dark">harmonic16-dark</option>
<option value="horizon-dark">horizon-dark</option>
<option value="horizon-terminal-dark">horizon-terminal-dark</option>
<option value="humanoid-dark">humanoid-dark</option>
<option value="ia-dark">ia-dark</option>
<option value="outrun-dark">outrun-dark</option>
<option value="papercolor-dark">papercolor-dark</option>
<option value="silk-dark">silk-dark</option>
<option value="solarized-dark">solarized-dark</option>
<option value="summerfruit-dark">summerfruit-dark</option>
<option value="synth-midnight-dark">synth-midnight-dark</option>
<option value="unikitty-dark">unikitty-dark</option>
        </select>
      </div>
    </div>
  </body>
</html>